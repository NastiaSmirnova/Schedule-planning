(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     77760,       1876]
NotebookOptionsPosition[     71870,       1783]
NotebookOutlinePosition[     72265,       1799]
CellTagsIndexPosition[     72222,       1796]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
1. \:0417\:0430\:043f\:0440\:043e\:0433\:0440\:0430\:043c\:043c\:0438\:0440\
\:043e\:0432\:0430\:0442\:044c \:0442\:043e\:0447\:043d\:0443\:044e \:043f\
\:043e\:0441\:0442\:0430\:043d\:043e\:0432\:043a\:0443 \:0434\:043b\:044f \
multidimensional multiway NPP \:0441 \:043a\:0440\:0438\:0442\:0435\:0440\
\:0438\:0435\:043c \:043e\:043f\:0442\:0438\:043c\:0438\:0437\:0430\:0446\
\:0438\:0438 : \:043c\:0438\:043d\:0438\:043c\:0438\:0437\:0430\:0446\:0438\
\:044f \:043c\:0430\:043a\:0441\:0438\:043c\:0430\:043b\:044c\:043d\:043e\
\:0439 \:0440\:0430\:0437\:043d\:043e\:0441\:0442\:0438 \:043f\:043e \:043a\
\:043e\:043c\:043f\:043e\:043d\:0435\:043d\:0442\:0435 (\:043f\:043e \:043a\
\:043e\:043e\:0440\:0434\:0438\:043d\:0430\:0442\:0435) \:043c\:0435\:0436\
\:0434\:0443 \:0441\:0443\:043c\:043c\:0430\:0440\:043d\:044b\:043c\:0438 \
\:0445\:0430\:0440\:0430\:043a\:0442\:0435\:0440\:0438\:0441\:0442\:0438\:043a\
\:0430\:043c\:0438 \:0433\:0440\:0443\:043f\:043f (\:043f\:043e\:0434\:043c\
\:043d\:043e\:0436\:0435\:0441\:0442\:0432)[\:0441\:0444\:043e\:0440\:043c\
\:0443\:043b\:0438\:0440\:043e\:0432\:0430\:043d\:0430 \:0432 \:043a\:043b\
\:0430\:0441\:0441\:0435] . \:041d\:0430\:0439\:0442\:0438 \:0440\:0435\:0448\
\:0435\:043d\:0438\:0435 \:0434\:043b\:044f \:0441\:043b\:0443\:0447\:0430\
\:0439\:043d\:043e \:0441\:0433\:0435\:043d\:0435\:0440\:0438\:0440\:043e\
\:0432\:0430\:043d\:043d\:044b\:0445 \:0434\:0430\:043d\:043d\:044b\:0445\
\>", "Subsubsection",
 CellChangeTimes->{{3.8413061392606554`*^9, 3.8413061490322485`*^9}},
 FontSize->14,ExpressionUUID->"385e2349-c475-4a4d-8214-c06306656c1a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"n", "=", "8"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "\:043a\:043e\:043b\:0438\:0447\:0435\:0441\:0442\:0432\:043e", " ", 
    "\:0432\:0435\:043a\:0442\:043e\:0440\:043e\:0432"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NC", "=", "4"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "\:0440\:0430\:0437\:043c\:0435\:0440\:043d\:043e\:0441\:0442\:044c", " ", 
    "\:0432\:0435\:043a\:0442\:043e\:0440\:043e\:0432"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"k", "=", "3"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "\:043a\:043e\:043b\:0438\:0447\:0435\:0441\:0442\:0432\:043e", " ", 
    "\:0433\:0440\:0443\:043f\:043f"}], "*)"}]}]}], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"5ae03d52-c06b-489e-a1eb-9baaf6e881b6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"initialData1", "=", " ", 
  RowBox[{"RandomInteger", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "20"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "NC"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.841241759517479*^9, 3.841241788012022*^9}, 
   3.841241853645121*^9, 3.84131447695638*^9, 3.8413145321879063`*^9},
 CellLabel->"In[4]:=",ExpressionUUID->"eb048d05-f5dd-44ee-8e1d-342248ba3262"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "15", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"20", ",", "13", ",", "2", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "5", ",", "7", ",", "13"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"17", ",", "18", ",", "5", ",", "12"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "4", ",", "17", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"11", ",", "20", ",", "6", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "4", ",", "1", ",", "11"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "7", ",", "1", ",", "3"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8412373872487326`*^9, 3.841238223535781*^9, 3.841239725652788*^9, 
   3.8412398294538393`*^9, 3.84123990284837*^9, 3.8412401340885277`*^9, 
   3.84124079199234*^9, 3.841240829293376*^9, 3.841240881857164*^9, 
   3.84124093094416*^9, 3.841241168571613*^9, {3.841241744762895*^9, 
   3.8412417486284103`*^9}, {3.8412417905115013`*^9, 3.84124181163912*^9}, 
   3.841241855096115*^9, {3.841244540278112*^9, 3.841244563366275*^9}, 
   3.841244598201167*^9, 3.841244736101131*^9, 3.8412452563847227`*^9, 
   3.8412452875705223`*^9, 3.841245638333309*^9, 3.8412457956470876`*^9, 
   3.8412459295281463`*^9, 3.8412459903951797`*^9, {3.841246062950113*^9, 
   3.8412460788103747`*^9}, 3.841246139980816*^9, 3.841246196022729*^9, 
   3.8412462484549747`*^9, 3.8412463228914156`*^9, {3.8412463612032285`*^9, 
   3.8412463706638775`*^9}, 3.841306845840189*^9, {3.8413144798440113`*^9, 
   3.8413145595418444`*^9}, 3.8413146349449315`*^9, 3.8413157874217324`*^9, 
   3.841315863113366*^9, 3.8413159745655403`*^9, 3.8413166617467337`*^9, 
   3.8413170308064737`*^9},
 CellLabel->"Out[4]=",ExpressionUUID->"1a86f7d1-a068-41b1-9463-5b0ace1f7b72"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"varsX", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"x", ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "k"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vars", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Flatten", "@", "varsX"}], ",", 
     RowBox[{"{", "delta", "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.841237415636298*^9, 3.841237429527994*^9}, {
  3.84123988791735*^9, 3.8412398904785566`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"b15b2852-b48f-4068-8b95-2802e0c27bd1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"objFun", "=", "delta"}], ";"}]], "Input",
 CellChangeTimes->{{3.8412374417621717`*^9, 3.841237442997378*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"bc7c81ef-2dd6-4fc6-889e-f69fd4da1164"],

Cell[BoxData[
 RowBox[{
  RowBox[{"c", "=", 
   RowBox[{"Last", "@", 
    RowBox[{"CoefficientArrays", "[", 
     RowBox[{"objFun", ",", "vars"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.84123986530867*^9, 3.841239865542529*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"e4552248-1e7b-40bf-886a-def0c324057c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"con1", "=", 
    RowBox[{"Total", "[", 
     RowBox[{"varsX", ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "\:043f\:0435\:0440\:0432\:043e\:0435", " ", 
    "\:0443\:0441\:043b\:043e\:0432\:0438\:0435"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhs1", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", "n"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.8412374799721622`*^9, {3.8412391216765485`*^9, 3.841239220620223*^9}, {
   3.841306183560107*^9, 3.8413061841875415`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"b4d0a92e-09c1-4af2-850b-60e76011b7c7"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"=", " ", 
     RowBox[{
      RowBox[{"-", " ", "'"}], 
      RowBox[{"0", "'"}]}]}], ",", " ", 
    RowBox[{"\[GreaterEqual]", " ", 
     RowBox[{
      RowBox[{"-", " ", "'"}], 
      RowBox[{"1", "'"}]}]}], ",", " ", 
    RowBox[{"\[LessEqual]", " ", 
     RowBox[{
      RowBox[{"-", " ", "'"}], "-", 
      RowBox[{"1", "'"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"J1J2", "=", 
     RowBox[{"Subsets", "[", 
      RowBox[{
       RowBox[{"Range", "[", "k", "]"}], ",", 
       RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "\:0432\:0430\:0440\:0438\:0430\:043d\:0442\:044b", " ", 
      "\:043f\:0430\:0440", " ", "\:043d\:043e\:043c\:0435\:0440\:043e\:0432",
       " ", "\:0433\:0440\:0443\:043f\:043f"}], ",", " ", 
     RowBox[{
      RowBox[{"\:0433\:0434\:0435", " ", "j1"}], "<", "j2"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"listL", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"listi", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"l", "=", "1"}], ",", 
      RowBox[{"l", "\[LessEqual]", "NC"}], ",", 
      RowBox[{"l", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "<=", 
         RowBox[{"Length", "[", "J1J2", "]"}]}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"listi", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", 
           RowBox[{"i", "\[LessEqual]", "n"}], ",", 
           RowBox[{"i", "++"}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"listi", ",", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Transpose", "[", "initialData1", "]"}], 
                "\[LeftDoubleBracket]", "l", "\[RightDoubleBracket]"}], 
               "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "varsX", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", 
                 RowBox[{
                  RowBox[{
                  "J1J2", "\[LeftDoubleBracket]", "j", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], "-", 
                RowBox[{
                 RowBox[{
                 "varsX", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", 
                 RowBox[{
                  RowBox[{
                  "J1J2", "\[LeftDoubleBracket]", "j", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}], 
               ")"}]}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"listL", ",", 
           RowBox[{"delta", "-", 
            RowBox[{"Total", "@", "listi"}]}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"con2", "=", "listL"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "\:0432\:0442\:043e\:0440\:043e\:0435", " ", 
     "\:0443\:0441\:043b\:043e\:0432\:0438\:0435"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rhs2", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"Length", "@", "listL"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8412375047787743`*^9, 3.841237517121092*^9}, {
   3.8412391952489347`*^9, 3.8412392332781167`*^9}, {3.841239265553959*^9, 
   3.841239275973064*^9}, {3.841240110418378*^9, 3.8412401106061115`*^9}, 
   3.8412425014953165`*^9, {3.8412425509179726`*^9, 3.841242621643233*^9}, {
   3.841242899016034*^9, 3.841242949182295*^9}, {3.841243071589922*^9, 
   3.841243087123911*^9}, {3.841245312046231*^9, 3.8412453385653753`*^9}, {
   3.84124547220192*^9, 3.8412455099039707`*^9}, {3.841246051247671*^9, 
   3.8412460538334007`*^9}, 3.8412461894914026`*^9, 3.841306192536006*^9, {
   3.8413144382687793`*^9, 3.8413144411822443`*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"60a4b53b-4ea6-4f13-b3c7-ade413eea325"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"listL", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"listi", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"l", "=", "1"}], ",", 
     RowBox[{"l", "\[LessEqual]", "NC"}], ",", 
     RowBox[{"l", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "<=", 
        RowBox[{"Length", "[", "J1J2", "]"}]}], ",", 
       RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"listi", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", "n"}], ",", 
          RowBox[{"i", "++"}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"listi", ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Transpose", "[", "initialData1", "]"}], 
               "\[LeftDoubleBracket]", "l", "\[RightDoubleBracket]"}], 
              "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                "varsX", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", 
                RowBox[{
                 RowBox[{
                 "J1J2", "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}], "-", 
               RowBox[{
                RowBox[{
                "varsX", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", 
                RowBox[{
                 RowBox[{
                 "J1J2", "\[LeftDoubleBracket]", "j", 
                  "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}], "\[RightDoubleBracket]"}]}], 
              ")"}]}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"listL", ",", 
          RowBox[{"delta", "+", 
           RowBox[{"Total", "@", "listi"}]}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"con3", "=", "listL"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "\:0442\:0440\:0435\:0442\:044c\:0435", " ", 
    "\:0443\:0441\:043b\:043e\:0432\:0438\:0435"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhs3", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"Length", "@", "listL"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8412393342696233`*^9, 3.8412393850831137`*^9}, {
   3.8412401323068314`*^9, 3.8412401324945784`*^9}, {3.8412453704241037`*^9, 
   3.8412454098829*^9}, {3.8412455223155985`*^9, 3.8412455226042175`*^9}, {
   3.841245666385504*^9, 3.8412457038443904`*^9}, 3.841246061448145*^9, 
   3.841246194680492*^9, {3.841246346364396*^9, 3.8412463478519573`*^9}, 
   3.8413061955726213`*^9, {3.841314465172331*^9, 3.841314468494768*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"3d0a8381-5be2-4985-98c2-49d9d6722046"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lu", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"ConstantArray", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"n", "*", "k"}]}], "]"}], ",", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"Total", "@", 
          RowBox[{"Total", "@", "initialData1"}]}]}], "}"}], ",", "1"}], 
      "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"domain", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"ConstantArray", "[", 
      RowBox[{"Integers", ",", 
       RowBox[{"n", "*", "k"}]}], "]"}], ",", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"Reals", ",", "1"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m", "=", 
   RowBox[{"Last", "@", 
    RowBox[{"CoefficientArrays", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{"con1", ",", "con2", ",", "con3"}], "]"}], ",", "vars"}], 
     "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8412394348590355`*^9, 3.841239435686884*^9}, {
   3.8412397030458097`*^9, 3.8412397102023764`*^9}, {3.8412403462806873`*^9, 
   3.84124035283949*^9}, 3.8412403932302127`*^9, 3.8412408780542603`*^9, 
   3.841241040024909*^9, {3.841241144528473*^9, 3.8412411482148275`*^9}, {
   3.841245775750618*^9, 3.841245784192794*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"7dee9aec-6e5f-4d30-9597-de582acb9288"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol", "=", 
  RowBox[{"LinearProgramming", "[", 
   RowBox[{"c", ",", "m", ",", 
    RowBox[{"Join", "[", 
     RowBox[{"rhs1", ",", "rhs2", ",", "rhs3"}], "]"}], ",", "lu", ",", 
    "domain"}], "]"}]}]], "Input",
 CellChangeTimes->{3.841240248370409*^9, 3.8412404157160273`*^9},
 CellLabel->"In[25]:=",ExpressionUUID->"a0bdd9a1-999f-438d-92b6-10a74bfa5689"],

Cell[BoxData[
 TemplateBox[{
  "LinearProgramming", "lpip", 
   "\"Warning: integer linear programming will use a machine-precision \
approximation of the inputs.\"", 2, 25, 1, 24604831426989653395, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.841239744794079*^9, 3.841239829707839*^9, 3.8412399055068617`*^9, 
   3.8412401344634743`*^9, {3.8412404029478855`*^9, 3.8412404161634693`*^9}, 
   3.841240793059737*^9, 3.841240829730773*^9, 3.8412408823257732`*^9, 
   3.8412409326661267`*^9, {3.8412411513097897`*^9, 3.8412411690929594`*^9}, {
   3.8412417450802636`*^9, 3.8412417489258337`*^9}, {3.8412417908935194`*^9, 
   3.8412418120410924`*^9}, 3.8412418554487867`*^9, {3.8412445408550887`*^9, 
   3.8412445638675423`*^9}, 3.841244598606267*^9, 3.8412447366677547`*^9, 
   3.841245256936042*^9, 3.8412452880157304`*^9, 3.8412456389785333`*^9, {
   3.841245789650441*^9, 3.8412457964698267`*^9}, 3.8412459303361244`*^9, 
   3.841245991134413*^9, {3.8412460636798286`*^9, 3.8412460796607265`*^9}, 
   3.841246140785676*^9, 3.841246196585103*^9, 3.841246249038103*^9, 
   3.8412463233746586`*^9, {3.8412463614995985`*^9, 3.8412463709407873`*^9}, 
   3.841306846215278*^9, {3.841314480250167*^9, 3.8413145599948626`*^9}, 
   3.841314635522919*^9, 3.841315787763199*^9, 3.8413158634057975`*^9, 
   3.841315974854094*^9, 3.8413166622139854`*^9, 3.8413170311551657`*^9},
 CellLabel->
  "During evaluation of \
In[25]:=",ExpressionUUID->"41291a95-dbcd-466f-b352-29a653c31e29"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", 
   ",", "1", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", 
   "0", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", 
   ",", "1", ",", "12.000000000000002`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.841245930426888*^9, 3.841245991225171*^9, {3.8412460640528345`*^9, 
   3.8412460799679084`*^9}, 3.8412461410889015`*^9, 3.841246197251429*^9, 
   3.841246249703628*^9, 3.841246323984066*^9, {3.841246362176365*^9, 
   3.8412463716060095`*^9}, 3.8413068472304883`*^9, {3.841314481062479*^9, 
   3.841314560525985*^9}, 3.8413146365024004`*^9, 3.841315788375303*^9, 
   3.8413158639463315`*^9, 3.8413159753496485`*^9, 3.8413166635252695`*^9, 
   3.841317032154193*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"e06b2749-1729-4cc2-b7b2-e841cde56250"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"partition", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Pick", "[", 
     RowBox[{"initialData1", ",", "#", ",", "1"}], "]"}], "&"}], "/@", 
   RowBox[{"Transpose", "[", 
    RowBox[{"Partition", "[", 
     RowBox[{
      RowBox[{"sol", "\[LeftDoubleBracket]", 
       RowBox[{";;", 
        RowBox[{"-", "2"}]}], "\[RightDoubleBracket]"}], ",", "k"}], "]"}], 
    "]"}], 
   RowBox[{"(*", 
    RowBox[{
    "\:043f\:043e\:043b\:0443\:0447\:0435\:043d\:043d\:043e\:0435", " ", 
     "\:0440\:0430\:0437\:0431\:0438\:0435\:043d\:0438\:0435", " ", 
     "\:0432\:0435\:043a\:0442\:043e\:0440\:043e\:0432", " ", "\:043d\:0430", 
     " ", "\:0433\:0440\:0443\:043f\:043f\:044b"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{
  3.8412408263949876`*^9, {3.8412412178376365`*^9, 3.841241224363529*^9}, {
   3.8412415416637225`*^9, 3.8412415421516733`*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"e6b6f568-345e-4fe7-bc1a-12b39eb41401"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"17", ",", "18", ",", "5", ",", "12"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "4", ",", "17", ",", "3"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "15", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"11", ",", "20", ",", "6", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "4", ",", "1", ",", "11"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"20", ",", "13", ",", "2", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "5", ",", "7", ",", "13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"8", ",", "7", ",", "1", ",", "3"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.8412404608620253`*^9, 3.841240793153431*^9, 3.8412408298933945`*^9, 
   3.8412408832878323`*^9, 3.8412409341313376`*^9, {3.8412411552932053`*^9, 
   3.8412411692960725`*^9}, 3.841241543323736*^9, {3.8412417451896133`*^9, 
   3.8412417490352163`*^9}, {3.8412417910141954`*^9, 3.841241812163847*^9}, 
   3.8412418555655537`*^9, {3.8412445409955626`*^9, 3.841244563999194*^9}, 
   3.8412445987556953`*^9, 3.841244736790425*^9, 3.8412452570637064`*^9, 
   3.8412452881384077`*^9, 3.841245639496438*^9, 3.8412457969905148`*^9, 
   3.8412459315222163`*^9, 3.8412459917128677`*^9, {3.841246064536386*^9, 
   3.8412460803046913`*^9}, 3.841246141964548*^9, 3.8412461974076777`*^9, 
   3.8412462498442197`*^9, 3.8412463241199923`*^9, {3.8412463622993755`*^9, 
   3.84124637170076*^9}, 3.841306847417979*^9, {3.8413144812187243`*^9, 
   3.841314560744683*^9}, 3.841314636924184*^9, 3.841315788556024*^9, 
   3.8413158640460405`*^9, 3.8413159754665146`*^9, 3.8413166639302173`*^9, 
   3.84131703239425*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"2243e9e8-a2f4-4121-a48d-520ddd0cf8e7"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
2. \:0421\:0444\:043e\:0440\:043c\:0443\:043b\:0438\:0440\:043e\:0432\:0430\
\:0442\:044c \:0438 \:0437\:0430\:043f\:0440\:043e\:0433\:0440\:0430\:043c\
\:043c\:0438\:0440\:043e\:0432\:0430\:0442\:044c \:0437\:0430\:0434\:0430\
\:0447\:0443 \:0434\:043b\:044f multidimensional multiway NPP \:0441 \:043a\
\:0440\:0438\:0442\:0435\:0440\:0438\:0435\:043c \:043e\:043f\:0442\:0438\
\:043c\:0438\:0437\:0430\:0446\:0438\:0438 : \:043c\:0438\:043d\:0438\:043c\
\:0438\:0437\:0430\:0446\:0438\:0438 \:0432\:0437\:0432\:0435\:0448\:0435\
\:043d\:043d\:043e\:0439 \:0441\:0443\:043c\:043c\:044b \:043e\:0442\:043d\
\:043e\:0441\:0438\:0442\:0435\:043b\:044c\:043d\:044b\:0445 \:043e\:0442\
\:043a\:043b\:043e\:043d\:0435\:043d\:0438\:0439 \:0441\:0443\:043c\:043c\
\:0430\:0440\:043d\:044b\:0445 \:0445\:0430\:0440\:0430\:043a\:0442\:0435\
\:0440\:0438\:0441\:0442\:0438\:043a \:0433\:0440\:0443\:043f\:043f \:043e\
\:0442 \:0438\:0434\:0435\:0430\:043b\:044c\:043d\:044b\:0445 \:0437\:043d\
\:0430\:0447\:0435\:043d\:0438\:0439 \:043f\:043e \:043a\:043e\:043e\:0440\
\:0434\:0438\:043d\:0430\:0442\:0430\:043c . \:041d\:0430\:0439\:0442\:0438 \
\:0440\:0435\:0448\:0435\:043d\:0438\:0435 \:0434\:043b\:044f \:0441\:043b\
\:0443\:0447\:0430\:0439\:043d\:043e \:0441\:0433\:0435\:043d\:0435\:0440\
\:0438\:0440\:043e\:0432\:0430\:043d\:043d\:044b\:0445 \:0434\:0430\:043d\
\:043d\:044b\:0445 .\
\>", "Subsubsection",
 CellChangeTimes->{{3.841306375916705*^9, 3.8413063864222536`*^9}, {
  3.8413067367496223`*^9, 3.8413067392255945`*^9}},
 FontSize->14,ExpressionUUID->"0666130c-1023-460c-ae8f-fc96abfa2a0d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"n", "=", "8"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "\:043a\:043e\:043b\:0438\:0447\:0435\:0441\:0442\:0432\:043e", " ", 
    "\:0432\:0435\:043a\:0442\:043e\:0440\:043e\:0432"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NC", "=", "4"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "\:0440\:0430\:0437\:043c\:0435\:0440\:043d\:043e\:0441\:0442\:044c", " ", 
    "\:0432\:0435\:043a\:0442\:043e\:0440\:043e\:0432"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"k", "=", "3"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "\:043a\:043e\:043b\:0438\:0447\:0435\:0441\:0442\:0432\:043e", " ", 
    "\:0433\:0440\:0443\:043f\:043f"}], "*)"}]}]}], "Input",
 CellLabel->"In[27]:=",ExpressionUUID->"f51a69b0-42ba-4048-89bb-9b7617b08212"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"weights2", "=", 
  RowBox[{"Normalize", "[", 
   RowBox[{
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "10"}], "}"}], ",", "NC"}], "]"}], ",", "Total"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"initialData2", "=", " ", 
  RowBox[{"RandomInteger", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "20"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "NC"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ideal2", " ", "=", " ", 
  RowBox[{
   RowBox[{"Total", "[", 
    RowBox[{"N", "@", "initialData2"}], "]"}], "/", "k"}]}]}], "Input",
 CellLabel->"In[30]:=",ExpressionUUID->"7205a734-6d5f-47db-b940-426988a4ac1f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.0846376341658012`", ",", "0.1583907706183341`", ",", 
   "0.4888204138991154`", ",", "0.2681511813167492`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8412522951866827`*^9, 3.841252474690529*^9, 3.8412525405440235`*^9, 
   3.841252656487709*^9, 3.8412526966624928`*^9, 3.841252791751174*^9, 
   3.841252861540187*^9, 3.8412529423265314`*^9, 3.84125299390036*^9, 
   3.8412530949985237`*^9, {3.8412547244155884`*^9, 3.84125482244645*^9}, 
   3.841306847872158*^9, {3.841314481484251*^9, 3.841314560932143*^9}, 
   3.8413146372209797`*^9, 3.841315788723785*^9, 3.8413158642459908`*^9, 
   3.8413159756643066`*^9, 3.841316664092969*^9, 3.841317032479985*^9},
 CellLabel->"Out[30]=",ExpressionUUID->"5f8d111b-9d9e-4c48-a8a5-903b790aa010"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"10", ",", "10", ",", "11", ",", "13"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"13", ",", "13", ",", "12", ",", "17"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "7", ",", "13", ",", "9"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"12", ",", "1", ",", "11", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"11", ",", "2", ",", "15", ",", "9"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"17", ",", "12", ",", "8", ",", "14"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"18", ",", "16", ",", "2", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "2", ",", "20", ",", "20"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8412522951866827`*^9, 3.841252474690529*^9, 3.8412525405440235`*^9, 
   3.841252656487709*^9, 3.8412526966624928`*^9, 3.841252791751174*^9, 
   3.841252861540187*^9, 3.8412529423265314`*^9, 3.84125299390036*^9, 
   3.8412530949985237`*^9, {3.8412547244155884`*^9, 3.84125482244645*^9}, 
   3.841306847872158*^9, {3.841314481484251*^9, 3.841314560932143*^9}, 
   3.8413146372209797`*^9, 3.841315788723785*^9, 3.8413158642459908`*^9, 
   3.8413159756643066`*^9, 3.841316664092969*^9, 3.841317032486724*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"200b91ac-d391-455c-a530-debc192589ba"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "30.666666666666664`", ",", "21.`", ",", "30.666666666666664`", ",", 
   "31.666666666666664`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8412522951866827`*^9, 3.841252474690529*^9, 3.8412525405440235`*^9, 
   3.841252656487709*^9, 3.8412526966624928`*^9, 3.841252791751174*^9, 
   3.841252861540187*^9, 3.8412529423265314`*^9, 3.84125299390036*^9, 
   3.8412530949985237`*^9, {3.8412547244155884`*^9, 3.84125482244645*^9}, 
   3.841306847872158*^9, {3.841314481484251*^9, 3.841314560932143*^9}, 
   3.8413146372209797`*^9, 3.841315788723785*^9, 3.8413158642459908`*^9, 
   3.8413159756643066`*^9, 3.841316664092969*^9, 3.841317032492141*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"e1ec29f9-afa5-454e-b2f2-43c651c1d572"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"varsX", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"x", ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "k"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varsDelta", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"delta", ",", 
     RowBox[{"{", 
      RowBox[{"NC", ",", "k"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vars", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Flatten", "@", "varsX"}], ",", 
     RowBox[{"Flatten", "@", "varsDelta"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.841237415636298*^9, 3.841237429527994*^9}, {
   3.84123988791735*^9, 3.8412398904785566`*^9}, {3.8412473919206276`*^9, 
   3.8412474152519274`*^9}, {3.841247450152729*^9, 3.8412474798103895`*^9}, {
   3.841247537039339*^9, 3.841247537719159*^9}, 3.8412492944288883`*^9, {
   3.8412494162011447`*^9, 3.841249427207923*^9}, {3.841252833369632*^9, 
   3.8412528440791492`*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"2b9a8fde-b181-4d1b-b8aa-6c01b253e6a6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"listFunk", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"l", "=", "1"}], ",", 
   RowBox[{"l", "\[LessEqual]", "NC"}], ",", 
   RowBox[{"l", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"j", "=", "1"}], ",", 
     RowBox[{"j", "\[LessEqual]", "k"}], ",", 
     RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"listFunk", ",", 
       RowBox[{
        RowBox[{
        "weights2", "\[LeftDoubleBracket]", "l", "\[RightDoubleBracket]"}], 
        "*", 
        RowBox[{"delta", "[", 
         RowBox[{"l", ",", "j"}], "]"}]}]}], "]"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.841247761903231*^9, 3.8412479466601505`*^9}, {
  3.841247991952075*^9, 3.841248066427088*^9}, {3.8412481051153173`*^9, 
  3.8412481252827845`*^9}, {3.8412482409722724`*^9, 3.8412482559193306`*^9}, {
  3.841248297823737*^9, 3.8412482984954634`*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"b416fce4-0807-4963-8e65-4fe71bae450d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"objFun", "=", 
   RowBox[{"Total", "@", "listFunk"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8412374417621717`*^9, 3.841237442997378*^9}, 
   3.8412483015262756`*^9},
 CellLabel->"In[38]:=",ExpressionUUID->"337a153a-fbc0-416f-a8b9-5999b8a7a651"],

Cell[BoxData[
 RowBox[{
  RowBox[{"c", "=", 
   RowBox[{"Last", "@", 
    RowBox[{"CoefficientArrays", "[", 
     RowBox[{"objFun", ",", "vars"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.84123986530867*^9, 3.841239865542529*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"33d126f6-aa91-4502-a539-212de337ab56"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"con1", "=", 
    RowBox[{"Total", "[", 
     RowBox[{"varsX", ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], " ", ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "\:043f\:0435\:0440\:0432\:043e\:0435", " ", 
    "\:0443\:0441\:043b\:043e\:0432\:0438\:0435"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhs1", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", "n"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.8412374799721622`*^9, {3.8412391216765485`*^9, 3.841239220620223*^9}, 
   3.841249096886176*^9, 3.84125285778415*^9},
 CellLabel->"In[40]:=",ExpressionUUID->"1c5fee72-f767-42be-a47d-218e6c642e45"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"=", " ", 
     RowBox[{
      RowBox[{"-", " ", "'"}], 
      RowBox[{"0", "'"}]}]}], ",", " ", 
    RowBox[{"\[GreaterEqual]", " ", 
     RowBox[{
      RowBox[{"-", " ", "'"}], 
      RowBox[{"1", "'"}]}]}], ",", " ", 
    RowBox[{"\[LessEqual]", " ", 
     RowBox[{
      RowBox[{"-", " ", "'"}], "-", 
      RowBox[{"1", "'"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"listY", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"l", "=", "1"}], ",", 
     RowBox[{"l", "\[LessEqual]", "NC"}], ",", 
     RowBox[{"l", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"listl", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", "k"}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"listl", ",", 
          RowBox[{
           RowBox[{"delta", "[", 
            RowBox[{"l", ",", "j"}], "]"}], "+", 
           RowBox[{
            RowBox[{"Dot", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Transpose", "[", "varsX", "]"}], 
               "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], ",", 
              RowBox[{
               RowBox[{"Transpose", "[", "initialData2", "]"}], 
               "\[LeftDoubleBracket]", "l", "\[RightDoubleBracket]"}]}], 
             "]"}], "/", 
            RowBox[{
            "ideal2", "\[LeftDoubleBracket]", "l", 
             "\[RightDoubleBracket]"}]}]}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"listY", ",", "listl"}], "]"}]}]}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"con2", "=", 
     RowBox[{"Flatten", "@", "listY"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "\:0432\:0442\:043e\:0440\:043e\:0435", " ", 
     "\:0443\:0441\:043b\:043e\:0432\:0438\:0435"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rhs2", "=", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], ",", 
       RowBox[{"NC", "*", "k"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8412375047787743`*^9, 3.841237517121092*^9}, {
   3.8412391952489347`*^9, 3.8412392332781167`*^9}, {3.841239265553959*^9, 
   3.841239275973064*^9}, {3.841240110418378*^9, 3.8412401106061115`*^9}, 
   3.8412425014953165`*^9, {3.8412425509179726`*^9, 3.841242621643233*^9}, {
   3.841242899016034*^9, 3.841242949182295*^9}, {3.841243071589922*^9, 
   3.841243087123911*^9}, {3.841245312046231*^9, 3.8412453385653753`*^9}, {
   3.84124547220192*^9, 3.8412455099039707`*^9}, {3.841246051247671*^9, 
   3.8412460538334007`*^9}, 3.8412461894914026`*^9, 3.8412496485561996`*^9, {
   3.8412515259659324`*^9, 3.8412515945264893`*^9}, {3.841252178669012*^9, 
   3.841252205388089*^9}, {3.8412525280289106`*^9, 3.841252529810244*^9}, 
   3.8412529376348543`*^9, 3.841254778271716*^9},
 CellLabel->"In[42]:=",ExpressionUUID->"fe9344e5-4ce2-4ae6-a90c-571943839c5f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"listY", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"l", "=", "1"}], ",", 
    RowBox[{"l", "\[LessEqual]", "NC"}], ",", 
    RowBox[{"l", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"listl", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "\[LessEqual]", "k"}], ",", 
       RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"listl", ",", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"delta", "[", 
            RowBox[{"l", ",", "j"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Dot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Transpose", "[", "varsX", "]"}], 
              "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], ",", 
             RowBox[{
              RowBox[{"Transpose", "[", "initialData2", "]"}], 
              "\[LeftDoubleBracket]", "l", "\[RightDoubleBracket]"}]}], "]"}],
            "/", 
           RowBox[{
           "ideal2", "\[LeftDoubleBracket]", "l", 
            "\[RightDoubleBracket]"}]}]}]}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"listY", ",", "listl"}], "]"}]}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"con3", "=", 
    RowBox[{"Flatten", "@", "listY"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "\:0442\:0440\:0435\:0442\:044c\:0435", " ", 
    "\:0443\:0441\:043b\:043e\:0432\:0438\:0435"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhs3", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"NC", "*", "k"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8412393342696233`*^9, 3.8412393850831137`*^9}, {
   3.8412401323068314`*^9, 3.8412401324945784`*^9}, {3.8412453704241037`*^9, 
   3.8412454098829*^9}, {3.8412455223155985`*^9, 3.8412455226042175`*^9}, {
   3.841245666385504*^9, 3.8412457038443904`*^9}, 3.841246061448145*^9, 
   3.841246194680492*^9, {3.841246346364396*^9, 3.8412463478519573`*^9}, {
   3.841252211259411*^9, 3.8412522642541704`*^9}, 3.841252537866642*^9, 
   3.8412529400086613`*^9, 3.8412547908479176`*^9},
 CellLabel->"In[46]:=",ExpressionUUID->"c4025e7e-0a2d-4e3d-83e6-c282ca419b9f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lu", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"ConstantArray", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"n", "*", "k"}]}], "]"}], ",", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"NC", "*", "k"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"domain", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"ConstantArray", "[", 
      RowBox[{"Integers", ",", 
       RowBox[{"n", "*", "k"}]}], "]"}], ",", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"Reals", ",", 
       RowBox[{"NC", "*", "k"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m", "=", 
   RowBox[{"Last", "@", 
    RowBox[{"CoefficientArrays", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{"con1", ",", "con2", ",", "con3"}], "]"}], ",", "vars"}], 
     "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8412394348590355`*^9, 3.841239435686884*^9}, {
   3.8412397030458097`*^9, 3.8412397102023764`*^9}, {3.8412403462806873`*^9, 
   3.84124035283949*^9}, 3.8412403932302127`*^9, 3.8412408780542603`*^9, 
   3.841241040024909*^9, {3.841241144528473*^9, 3.8412411482148275`*^9}, {
   3.841245775750618*^9, 3.841245784192794*^9}, {3.8412493596511774`*^9, 
   3.8412493625252676`*^9}, {3.841249495774712*^9, 3.8412494998820457`*^9}, {
   3.8412526464472847`*^9, 3.8412526542872796`*^9}, 3.84125269128465*^9, 
   3.8412527398475876`*^9, {3.8412527815028768`*^9, 3.8412527901010003`*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"f7dfc850-2e26-4718-9386-f2c4055dc05c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol", "=", 
  RowBox[{"LinearProgramming", "[", 
   RowBox[{"c", ",", "m", ",", 
    RowBox[{"Join", "[", 
     RowBox[{"rhs1", ",", "rhs2", ",", "rhs3"}], "]"}], ",", "lu", ",", 
    "domain"}], "]"}]}]], "Input",
 CellChangeTimes->{3.841240248370409*^9, 3.8412404157160273`*^9},
 CellLabel->"In[53]:=",ExpressionUUID->"dc48650f-16cd-48f8-9e2f-1be1815d70d8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "1", 
   ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1", ",", 
   "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "1", ",", "0", 
   ",", "0", ",", "0.4130434782608697`", ",", "0.04347826086956522`", ",", 
   "0.3695652173913044`", ",", "0.42857142857142866`", ",", 
   "0.04761904761904773`", ",", "0.476190476190476`", ",", 
   "0.01086956521739108`", ",", "0.04347826086956526`", ",", 
   "0.05434782608695653`", ",", "0.042105263157894604`", ",", 
   "0.02105263157894737`", ",", "0.02105263157894737`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.841245930426888*^9, 3.841245991225171*^9, {3.8412460640528345`*^9, 
   3.8412460799679084`*^9}, 3.8412461410889015`*^9, 3.841246197251429*^9, 
   3.841246249703628*^9, 3.841246323984066*^9, {3.841246362176365*^9, 
   3.8412463716060095`*^9}, 3.84125229689573*^9, 3.8412524758680587`*^9, 
   3.8412525417966948`*^9, 3.841252657868903*^9, 3.841252697999535*^9, 
   3.8412527931738772`*^9, 3.841252862461846*^9, 3.8412529448372345`*^9, 
   3.841252996216339*^9, 3.8412530963732405`*^9, 3.841254725430977*^9, {
   3.841254757297085*^9, 3.841254794998734*^9}, 3.8412548257614374`*^9, 
   3.8413068495609922`*^9, {3.841314483422184*^9, 3.841314562140547*^9}, 
   3.8413146405089235`*^9, 3.8413157902470803`*^9, 3.8413158659374*^9, 
   3.8413159773091855`*^9, 3.841316667363882*^9, 3.8413170348808966`*^9},
 CellLabel->"Out[53]=",ExpressionUUID->"81c1ce68-17ad-4876-90a1-00ed00d3e059"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"partition", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Pick", "[", 
     RowBox[{"initialData2", ",", "#", ",", "1"}], "]"}], "&"}], "/@", 
   RowBox[{"Transpose", "[", 
    RowBox[{"Partition", "[", 
     RowBox[{
      RowBox[{"sol", "\[LeftDoubleBracket]", 
       RowBox[{";;", 
        RowBox[{"-", "11"}]}], "\[RightDoubleBracket]"}], ",", "k"}], "]"}], 
    "]"}], 
   RowBox[{"(*", 
    RowBox[{
    "\:043f\:043e\:043b\:0443\:0447\:0435\:043d\:043d\:043e\:0435", " ", 
     "\:0440\:0430\:0437\:0431\:0438\:0435\:043d\:0438\:0435", " ", 
     "\:0432\:0435\:043a\:0442\:043e\:0440\:043e\:0432", " ", "\:043d\:0430", 
     " ", "\:0433\:0440\:0443\:043f\:043f\:044b"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{
  3.8412408263949876`*^9, {3.8412412178376365`*^9, 3.841241224363529*^9}, {
   3.8412415416637225`*^9, 3.8412415421516733`*^9}, {3.8412529741356277`*^9, 
   3.841252982824912*^9}, 3.8412530546519976`*^9},
 CellLabel->"In[54]:=",ExpressionUUID->"fa0ddfc8-cc09-4c12-a711-242e6202862d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"10", ",", "10", ",", "11", ",", "13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"8", ",", "2", ",", "20", ",", "20"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "7", ",", "13", ",", "9"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"12", ",", "1", ",", "11", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"17", ",", "12", ",", "8", ",", "14"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"13", ",", "13", ",", "12", ",", "17"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"11", ",", "2", ",", "15", ",", "9"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"18", ",", "16", ",", "2", ",", "5"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.8412404608620253`*^9, 3.841240793153431*^9, 3.8412408298933945`*^9, 
   3.8412408832878323`*^9, 3.8412409341313376`*^9, {3.8412411552932053`*^9, 
   3.8412411692960725`*^9}, 3.841241543323736*^9, {3.8412417451896133`*^9, 
   3.8412417490352163`*^9}, {3.8412417910141954`*^9, 3.841241812163847*^9}, 
   3.8412418555655537`*^9, {3.8412445409955626`*^9, 3.841244563999194*^9}, 
   3.8412445987556953`*^9, 3.841244736790425*^9, 3.8412452570637064`*^9, 
   3.8412452881384077`*^9, 3.841245639496438*^9, 3.8412457969905148`*^9, 
   3.8412459315222163`*^9, 3.8412459917128677`*^9, {3.841246064536386*^9, 
   3.8412460803046913`*^9}, 3.841246141964548*^9, 3.8412461974076777`*^9, 
   3.8412462498442197`*^9, 3.8412463241199923`*^9, {3.8412463622993755`*^9, 
   3.84124637170076*^9}, 3.8412522972862625`*^9, 3.8412524761804876`*^9, 
   3.8412525420622597`*^9, 3.841252658730112*^9, 3.8412526988503733`*^9, 
   3.841252794199933*^9, 3.8412528627989607`*^9, 3.8412529451027613`*^9, {
   3.841252975447854*^9, 3.841252996435031*^9}, 3.841253057732422*^9, 
   3.8412530965606527`*^9, 3.8412547256340523`*^9, {3.841254759058083*^9, 
   3.841254795201847*^9}, 3.841254826190728*^9, 3.841306849705244*^9, {
   3.8413144835880723`*^9, 3.841314562328003*^9}, 3.8413146407220187`*^9, 
   3.841315790422161*^9, 3.8413158660962877`*^9, 3.8413159774832373`*^9, 
   3.8413166676486597`*^9, 3.841317034966419*^9},
 CellLabel->"Out[54]=",ExpressionUUID->"263728ee-b275-417a-9518-b1a77ac2bb40"]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.8413068723889923`*^9},
 CellLabel->"In[55]:=",ExpressionUUID->"c9e3ea6b-98db-4148-82df-f66c98fd4b16"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
3. C\:0444\:043e\:0440\:043c\:0443\:043b\:0438\:0440\:043e\:0432\:0430\:0442\
\:044c \:0438 \:0437\:0430\:043f\:0440\:043e\:0433\:0440\:0430\:043c\:043c\
\:0438\:0440\:043e\:0432\:0430\:0442\:044c \:0437\:0430\:0434\:0430\:0447\
\:0443 \:0434\:043b\:044f multidimensional multiway NPP \:0441 \:043a\:0440\
\:0438\:0442\:0435\:0440\:0438\:0435\:043c \:043e\:043f\:0442\:0438\:043c\
\:0438\:0437\:0430\:0446\:0438\:0438 : \:043c\:0438\:043d\:0438\:043c\:0438\
\:0437\:0430\:0446\:0438\:0438 \:0432\:0437\:0432\:0435\:0448\:0435\:043d\
\:043d\:043e\:0439 \:0441\:0443\:043c\:043c\:044b \:043e\:0442\:043d\:043e\
\:0441\:0438\:0442\:0435\:043b\:044c\:043d\:044b\:0445 \:043e\:0442\:043a\
\:043b\:043e\:043d\:0435\:043d\:0438\:0439 \:0441\:0443\:043c\:043c\:0430\
\:0440\:043d\:044b\:0445 \:0445\:0430\:0440\:0430\:043a\:0442\:0435\:0440\
\:0438\:0441\:0442\:0438\:043a \:0433\:0440\:0443\:043f\:043f \:043e\:0442 \
\:0438\:0434\:0435\:0430\:043b\:044c\:043d\:044b\:0445 \:0437\:043d\:0430\
\:0447\:0435\:043d\:0438\:0439 \:043f\:043e \:043a\:043e\:043e\:0440\:0434\
\:0438\:043d\:0430\:0442\:0430\:043c \:0434\:043b\:044f \:043a\:0430\:0436\
\:0434\:043e\:0439 \:0433\:0440\:0443\:043f\:043f\:044b . \:041d\:0430\:0439\
\:0442\:0438 \:0440\:0435\:0448\:0435\:043d\:0438\:0435 \:0434\:043b\:044f \
\:0441\:043b\:0443\:0447\:0430\:0439\:043d\:043e \:0441\:0433\:0435\:043d\
\:0435\:0440\:0438\:0440\:043e\:0432\:0430\:043d\:043d\:044b\:0445 \:0434\
\:0430\:043d\:043d\:044b\:0445 .\
\>", "Subsubsection",
 CellChangeTimes->{{3.8413068052145195`*^9, 3.8413068199267015`*^9}},
 FontSize->14,ExpressionUUID->"cc7b2c35-4047-4755-b8e1-af3c3244fce4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"n", "=", "8"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "\:043a\:043e\:043b\:0438\:0447\:0435\:0441\:0442\:0432\:043e", " ", 
    "\:0432\:0435\:043a\:0442\:043e\:0440\:043e\:0432"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NC", "=", "4"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "\:0440\:0430\:0437\:043c\:0435\:0440\:043d\:043e\:0441\:0442\:044c", " ", 
    "\:0432\:0435\:043a\:0442\:043e\:0440\:043e\:0432"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"k", "=", "3"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "\:043a\:043e\:043b\:0438\:0447\:0435\:0441\:0442\:0432\:043e", " ", 
    "\:0433\:0440\:0443\:043f\:043f"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "\:0438\:0441\:0445\:043e\:0434\:043d\:044b\:0435", " ", 
    "\:0434\:0430\:043d\:043d\:044b\:0435", " ", "\:0434\:043b\:044f", " ", 
    "\:0437\:0430\:0434\:0430\:0447\:0438"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"weights3", "=", 
  RowBox[{"Normalize", "[", 
   RowBox[{
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "10"}], "}"}], ",", "NC"}], "]"}], ",", "Total"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"initialData3", "=", " ", 
  RowBox[{"RandomInteger", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "20"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "k", ",", "NC"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"ideals3", "=", 
  RowBox[{
   RowBox[{"Total", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"N", "@", "initialData3"}], "\[Transpose]"}], ",", 
     RowBox[{"{", "2", "}"}]}], "]"}], "/", "k"}]}]}], "Input",
 CellChangeTimes->{{3.841253495647778*^9, 3.841253503618619*^9}, {
  3.8412555098889265`*^9, 3.841255510295084*^9}, {3.8412564126531253`*^9, 
  3.841256414277707*^9}, {3.8412565381272964`*^9, 3.8412565475092535`*^9}, {
  3.8412585241940393`*^9, 3.841258532073635*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"14aad255-5d7f-4512-a6d0-e34da3bc4949"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.12743092100341286`", ",", "0.15862920355615442`", ",", 
   "0.3124640394975488`", ",", "0.4014758359428838`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8412535076123376`*^9, 3.8412536014403543`*^9, 3.841254496687384*^9, 
   3.8412545680531173`*^9, 3.8412550514183764`*^9, 3.841255515437262*^9, 
   3.84125584924023*^9, 3.8412559908418837`*^9, 3.84125625754134*^9, 
   3.841256416636528*^9, {3.841256540531764*^9, 3.8412565522004642`*^9}, 
   3.84125692877586*^9, 3.841257093609229*^9, 3.8412571414619274`*^9, 
   3.8412576462966256`*^9, 3.8412580385508347`*^9, 3.841258113475219*^9, 
   3.841258432109829*^9, {3.841258504414873*^9, 3.841258534239666*^9}, 
   3.8413068498146114`*^9, {3.841314483709672*^9, 3.8413145624842176`*^9}, 
   3.841314640925061*^9, 3.8413157905903025`*^9, 3.8413158662323837`*^9, 
   3.841315977699973*^9, 3.841316667813156*^9, 3.841317035052921*^9},
 CellLabel->"Out[59]=",ExpressionUUID->"abb75991-f9cc-4998-aa26-2ee56ec25fb9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"20", ",", "16", ",", "15", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"20", ",", "17", ",", "10", ",", "19"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"8", ",", "7", ",", "8", ",", "6"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"9", ",", "9", ",", "3", ",", "9"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"12", ",", "13", ",", "1", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "19", ",", "4", ",", "19"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "10", ",", "16", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "17", ",", "13", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"14", ",", "19", ",", "5", ",", "16"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "10", ",", "4", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "19", ",", "6", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"7", ",", "4", ",", "16", ",", "3"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"11", ",", "4", ",", "2", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "7", ",", "3", ",", "19"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"12", ",", "2", ",", "5", ",", "10"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "10", ",", "15", ",", "19"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"11", ",", "3", ",", "19", ",", "17"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "16", ",", "10", ",", "11"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", "11", ",", "11", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "3", ",", "4", ",", "15"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"7", ",", "6", ",", "17", ",", "4"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "18", ",", "11", ",", "12"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"12", ",", "1", ",", "7", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"20", ",", "9", ",", "15", ",", "19"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.8412535076123376`*^9, 3.8412536014403543`*^9, 3.841254496687384*^9, 
   3.8412545680531173`*^9, 3.8412550514183764`*^9, 3.841255515437262*^9, 
   3.84125584924023*^9, 3.8412559908418837`*^9, 3.84125625754134*^9, 
   3.841256416636528*^9, {3.841256540531764*^9, 3.8412565522004642`*^9}, 
   3.84125692877586*^9, 3.841257093609229*^9, 3.8412571414619274`*^9, 
   3.8412576462966256`*^9, 3.8412580385508347`*^9, 3.841258113475219*^9, 
   3.841258432109829*^9, {3.841258504414873*^9, 3.841258534239666*^9}, 
   3.8413068498146114`*^9, {3.841314483709672*^9, 3.8413145624842176`*^9}, 
   3.841314640925061*^9, 3.8413157905903025`*^9, 3.8413158662323837`*^9, 
   3.841315977699973*^9, 3.841316667813156*^9, 3.8413170350726385`*^9},
 CellLabel->"Out[60]=",ExpressionUUID->"239a20e3-5d28-46b5-93d8-8b59c2c1b754"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "17.666666666666664`", ",", "29.333333333333332`", ",", 
     "25.666666666666664`", ",", "18.666666666666664`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "23.666666666666664`", ",", "26.666666666666664`", ",", "21.`", ",", 
     "30.666666666666664`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "27.`", ",", "27.333333333333332`", ",", "26.666666666666664`", ",", 
     "29.333333333333332`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8412535076123376`*^9, 3.8412536014403543`*^9, 3.841254496687384*^9, 
   3.8412545680531173`*^9, 3.8412550514183764`*^9, 3.841255515437262*^9, 
   3.84125584924023*^9, 3.8412559908418837`*^9, 3.84125625754134*^9, 
   3.841256416636528*^9, {3.841256540531764*^9, 3.8412565522004642`*^9}, 
   3.84125692877586*^9, 3.841257093609229*^9, 3.8412571414619274`*^9, 
   3.8412576462966256`*^9, 3.8412580385508347`*^9, 3.841258113475219*^9, 
   3.841258432109829*^9, {3.841258504414873*^9, 3.841258534239666*^9}, 
   3.8413068498146114`*^9, {3.841314483709672*^9, 3.8413145624842176`*^9}, 
   3.841314640925061*^9, 3.8413157905903025`*^9, 3.8413158662323837`*^9, 
   3.841315977699973*^9, 3.841316667813156*^9, 3.841317035082241*^9},
 CellLabel->"Out[61]=",ExpressionUUID->"33635032-9631-4fe0-9e5a-e2b4e7e9f519"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"varsX", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"x", ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "k"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varsDelta", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"delta", ",", 
     RowBox[{"{", 
      RowBox[{"NC", ",", "k"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vars", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Flatten", "@", "varsX"}], ",", 
     RowBox[{"Flatten", "@", "varsDelta"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.841257124399764*^9, 3.8412571384318867`*^9}, {
   3.841257514647578*^9, 3.8412575170122547`*^9}, {3.84125840391346*^9, 
   3.8412584061972623`*^9}, {3.8413159215884533`*^9, 3.841315926320591*^9}, 
   3.8413159732528143`*^9},
 CellLabel->"In[62]:=",ExpressionUUID->"a296a15c-5e6e-48b7-8ab2-795b9545b628"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"listFunk", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"l", "=", "1"}], ",", 
   RowBox[{"l", "\[LessEqual]", "NC"}], ",", 
   RowBox[{"l", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"j", "=", "1"}], ",", 
     RowBox[{"j", "\[LessEqual]", "k"}], ",", 
     RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"listFunk", ",", 
       RowBox[{
        RowBox[{
        "weights3", "\[LeftDoubleBracket]", "l", "\[RightDoubleBracket]"}], 
        "*", 
        RowBox[{"delta", "[", 
         RowBox[{"l", ",", "j"}], "]"}]}]}], "]"}]}], "]"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{
  3.8412542415865016`*^9, {3.841257127796277*^9, 3.8412571300691986`*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"b16b77ff-dda6-4e73-bad0-b9d996c7dd56"],

Cell[BoxData[
 RowBox[{
  RowBox[{"objFun", "=", 
   RowBox[{"Total", "@", "listFunk"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.8412542129205904`*^9, 3.841254492522938*^9, {3.841256593591919*^9, 
   3.8412566131193542`*^9}, {3.841257212360937*^9, 3.8412572137691*^9}, 
   3.841258409200412*^9},
 CellLabel->"In[67]:=",ExpressionUUID->"82a2f875-2f12-4eec-b0f3-a742210acc81"],

Cell[BoxData[
 RowBox[{
  RowBox[{"c", "=", 
   RowBox[{"Last", "@", 
    RowBox[{"CoefficientArrays", "[", 
     RowBox[{"objFun", ",", "vars"}], "]"}]}]}], ";"}]], "Input",
 CellLabel->"In[68]:=",ExpressionUUID->"9a3c4801-30ef-4653-aa97-a2314c168b28"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"con1", "=", 
    RowBox[{"Total", "[", 
     RowBox[{"varsX", ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], " ", ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "\:043f\:0435\:0440\:0432\:043e\:0435", " ", 
    "\:0443\:0441\:043b\:043e\:0432\:0438\:0435"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhs1", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", "n"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.8412572496101403`*^9, 3.84125795889143*^9, {3.841258412765266*^9, 
   3.84125841357708*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"123224bb-b579-4d01-ab1c-46046231f495"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"listY", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"l", "=", "1"}], ",", 
    RowBox[{"l", "\[LessEqual]", "NC"}], ",", 
    RowBox[{"l", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"listl", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "\[LessEqual]", "k"}], ",", 
       RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"listl", ",", 
         RowBox[{
          RowBox[{"delta", "[", 
           RowBox[{"l", ",", "j"}], "]"}], "+", 
          RowBox[{
           RowBox[{"Dot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Transpose", "[", "varsX", "]"}], 
              "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], ",", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"Transpose", "[", "initialData3", "]"}], 
                "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], "]"}],
               "\[LeftDoubleBracket]", "l", "\[RightDoubleBracket]"}]}], 
            "]"}], "/", 
           RowBox[{
            RowBox[{
            "ideals3", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}],
             "\[LeftDoubleBracket]", "l", "\[RightDoubleBracket]"}]}]}]}], 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"listY", ",", "listl"}], "]"}]}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"con2", "=", 
    RowBox[{"Flatten", "@", "listY"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "\:0432\:0442\:043e\:0440\:043e\:0435", " ", 
    "\:0443\:0441\:043b\:043e\:0432\:0438\:0435"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhs2", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"NC", "*", "k"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8412545462536273`*^9, 3.8412545561820054`*^9}, {
   3.8412549335244865`*^9, 3.8412549424800835`*^9}, 3.8412556759150743`*^9, 
   3.841256251962675*^9, 3.841258010289756*^9, {3.8412584181310005`*^9, 
   3.8412584191028767`*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"dad89056-cb6b-4395-b6e7-a3c692a0efcf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"listY", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"l", "=", "1"}], ",", 
    RowBox[{"l", "\[LessEqual]", "NC"}], ",", 
    RowBox[{"l", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"listl", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "\[LessEqual]", "k"}], ",", 
       RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"listl", ",", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"delta", "[", 
            RowBox[{"l", ",", "j"}], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Dot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Transpose", "[", "varsX", "]"}], 
              "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], ",", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"Transpose", "[", "initialData3", "]"}], 
                "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], "]"}],
               "\[LeftDoubleBracket]", "l", "\[RightDoubleBracket]"}]}], 
            "]"}], "/", 
           RowBox[{
            RowBox[{
            "ideals3", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}],
             "\[LeftDoubleBracket]", "l", "\[RightDoubleBracket]"}]}]}]}], 
        "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"listY", ",", "listl"}], "]"}]}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"con3", "=", 
    RowBox[{"Flatten", "@", "listY"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "\:0442\:0440\:0435\:0442\:044c\:0435", " ", 
    "\:0443\:0441\:043b\:043e\:0432\:0438\:0435"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhs3", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"NC", "*", "k"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8412557445689154`*^9, 3.8412557836176558`*^9}, 
   3.8412562553074713`*^9, 3.8412570904454384`*^9, 3.841257150418206*^9, {
   3.8412580234886665`*^9, 3.841258025298715*^9}, {3.841258109064554*^9, 
   3.841258111313369*^9}, 3.841258422672377*^9},
 CellLabel->"In[75]:=",ExpressionUUID->"3d9e5946-4af5-4d1a-ba54-9b7853e2c767"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lu", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"ConstantArray", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"n", "*", "k"}]}], "]"}], ",", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"NC", "*", "k"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"domain", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"ConstantArray", "[", 
      RowBox[{"Integers", ",", 
       RowBox[{"n", "*", "k"}]}], "]"}], ",", " ", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"Reals", ",", 
       RowBox[{"NC", "*", "k"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m", "=", 
   RowBox[{"Last", "@", 
    RowBox[{"CoefficientArrays", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{"con1", ",", "con2", ",", "con3"}], "]"}], ",", "vars"}], 
     "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{3.8412573031411552`*^9, 3.8412584249667563`*^9},
 CellLabel->"In[79]:=",ExpressionUUID->"7489b470-0a1a-4303-b8fd-d3e63e8603d5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol", "=", 
  RowBox[{"LinearProgramming", "[", 
   RowBox[{"c", ",", "m", ",", 
    RowBox[{"Join", "[", 
     RowBox[{"rhs1", ",", "rhs2", ",", "rhs3"}], "]"}], ",", "lu", ",", 
    "domain"}], "]"}]}]], "Input",
 CellChangeTimes->{3.8412584265167913`*^9, 3.8412585088713055`*^9},
 CellLabel->"In[82]:=",ExpressionUUID->"688fe728-379d-400d-85ae-687b0ae94f34"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1", 
   ",", "0", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "1", ",", "0.3018867924528305`", ",", "0.014084507042253603`", ",", 
   "0.1481481481481483`", ",", "0.15909090909090914`", ",", 
   "0.27500000000000013`", ",", "0.08536585365853645`", ",", 
   "0.2207792207792207`", ",", "0.09523809523809526`", ",", 
   "0.06249999999999989`", ",", "0.017857142857142988`", ",", 
   "0.11956521739130445`", ",", "0.022727272727272856`"}], "}"}]], "Output",
 CellChangeTimes->{{3.8412585124637513`*^9, 3.8412585355474243`*^9}, 
   3.8413068516659307`*^9, {3.841314485704266*^9, 3.8413145124101443`*^9}, {
   3.841314542546118*^9, 3.8413145639093466`*^9}, 3.841314642397458*^9, 
   3.84131579184763*^9, 3.841315867524517*^9, 3.8413159795291586`*^9, 
   3.8413166694865265`*^9, 3.8413170364027615`*^9},
 CellLabel->"Out[82]=",ExpressionUUID->"c5f0ec39-ef8f-43db-8031-e98e391e3701"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"partition", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Pick", "[", 
     RowBox[{"initialData3", ",", "#", ",", "1"}], "]"}], "&"}], "/@", 
   RowBox[{"Transpose", "[", 
    RowBox[{"Partition", "[", 
     RowBox[{
      RowBox[{"sol", "\[LeftDoubleBracket]", 
       RowBox[{";;", 
        RowBox[{"-", "11"}]}], "\[RightDoubleBracket]"}], ",", "k"}], "]"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.841255894480328*^9, 3.841255894870858*^9}, 
   3.8412584283922157`*^9, 3.8412584998141413`*^9},
 CellLabel->"In[83]:=",ExpressionUUID->"b9de42f1-dda8-4e50-959c-ee6d506d7009"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"9", ",", "9", ",", "3", ",", "9"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"12", ",", "13", ",", "1", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"10", ",", "19", ",", "4", ",", "19"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "10", ",", "4", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5", ",", "19", ",", "6", ",", "8"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"7", ",", "4", ",", "16", ",", "3"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"11", ",", "4", ",", "2", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "7", ",", "3", ",", "19"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"12", ",", "2", ",", "5", ",", "10"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "11", ",", "11", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "3", ",", "4", ",", "15"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"7", ",", "6", ",", "17", ",", "4"}], "}"}]}], "}"}]}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"20", ",", "16", ",", "15", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"20", ",", "17", ",", "10", ",", "19"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"8", ",", "7", ",", "8", ",", "6"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"3", ",", "10", ",", "16", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "17", ",", "13", ",", "8"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"14", ",", "19", ",", "5", ",", "16"}], "}"}]}], "}"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"3", ",", "10", ",", "15", ",", "19"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"11", ",", "3", ",", "19", ",", "17"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "16", ",", "10", ",", "11"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"4", ",", "18", ",", "11", ",", "12"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"12", ",", "1", ",", "7", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"20", ",", "9", ",", "15", ",", "19"}], "}"}]}], "}"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.841315867712523*^9, 3.8413159796808724`*^9, 
  3.841316669630971*^9, 3.841317036499143*^9},
 CellLabel->"Out[83]=",ExpressionUUID->"347b1abf-509e-4992-b1dc-035e3cb51a47"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"result", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "\[LessEqual]", 
    RowBox[{"Length", "[", "partition", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"group", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j", "=", "1"}], ",", 
      RowBox[{"j", "\[LessEqual]", 
       RowBox[{"Length", "[", 
        RowBox[{
        "partition", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
        "]"}]}], ",", 
      RowBox[{"j", "++"}], ",", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"group", ",", 
        RowBox[{"partition", "\[LeftDoubleBracket]", 
         RowBox[{"i", ",", "j", ",", "i"}], "\[RightDoubleBracket]"}]}], 
       "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"result", ",", "group"}], "]"}]}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", "result"}], "Input",
 CellChangeTimes->{{3.841315446647912*^9, 3.8413157094218287`*^9}, {
  3.841315774344559*^9, 3.8413157748593674`*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"d7b04e4a-6c51-4637-9216-78b5a00d93a9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"9", ",", "9", ",", "3", ",", "9"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "10", ",", "4", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"11", ",", "4", ",", "2", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "11", ",", "11", ",", "3"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"20", ",", "17", ",", "10", ",", "19"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "17", ",", "13", ",", "8"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "16", ",", "10", ",", "11"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"20", ",", "9", ",", "15", ",", "19"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.841315696701063*^9, 3.841315711590024*^9}, {
   3.8413157759408517`*^9, 3.8413157923895273`*^9}, 3.841315867846425*^9, 
   3.841315979769064*^9, 3.8413166697314935`*^9, 3.8413170365464325`*^9},
 CellLabel->"Out[86]=",ExpressionUUID->"649e53ae-64ee-49bc-93f2-38e8b1a35c60"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{949, 467},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"8d0d4c7d-fa20-4fb8-bdff-1e83c83baa59"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1622, 22, 76, "Subsubsection",ExpressionUUID->"385e2349-c475-4a4d-8214-c06306656c1a"],
Cell[2205, 46, 829, 24, 67, "Input",ExpressionUUID->"5ae03d52-c06b-489e-a1eb-9baaf6e881b6"],
Cell[CellGroupData[{
Cell[3059, 74, 448, 10, 28, "Input",ExpressionUUID->"eb048d05-f5dd-44ee-8e1d-342248ba3262"],
Cell[3510, 86, 1852, 35, 32, "Output",ExpressionUUID->"1a86f7d1-a068-41b1-9463-5b0ace1f7b72"]
}, Open  ]],
Cell[5377, 124, 572, 15, 48, "Input",ExpressionUUID->"b15b2852-b48f-4068-8b95-2802e0c27bd1"],
Cell[5952, 141, 222, 4, 28, "Input",ExpressionUUID->"bc7c81ef-2dd6-4fc6-889e-f69fd4da1164"],
Cell[6177, 147, 317, 7, 28, "Input",ExpressionUUID->"e4552248-1e7b-40bf-886a-def0c324057c"],
Cell[6497, 156, 740, 21, 48, "Input",ExpressionUUID->"b4d0a92e-09c1-4af2-850b-60e76011b7c7"],
Cell[7240, 179, 4750, 116, 314, "Input",ExpressionUUID->"60a4b53b-4ea6-4f13-b3c7-ade413eea325"],
Cell[11993, 297, 3482, 84, 257, "Input",ExpressionUUID->"3d0a8381-5be2-4985-98c2-49d9d6722046"],
Cell[15478, 383, 1505, 40, 67, "Input",ExpressionUUID->"7dee9aec-6e5f-4d30-9597-de582acb9288"],
Cell[CellGroupData[{
Cell[17008, 427, 383, 8, 28, "Input",ExpressionUUID->"a0bdd9a1-999f-438d-92b6-10a74bfa5689"],
Cell[17394, 437, 1499, 24, 28, "Message",ExpressionUUID->"41291a95-dbcd-466f-b352-29a653c31e29"],
Cell[18896, 463, 904, 15, 32, "Output",ExpressionUUID->"e06b2749-1729-4cc2-b7b2-e841cde56250"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19837, 483, 949, 22, 48, "Input",ExpressionUUID->"e6b6f568-345e-4fe7-bc1a-12b39eb41401"],
Cell[20789, 507, 1947, 41, 32, "Output",ExpressionUUID->"2243e9e8-a2f4-4121-a48d-520ddd0cf8e7"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[22785, 554, 1609, 23, 57, "Subsubsection",ExpressionUUID->"0666130c-1023-460c-ae8f-fc96abfa2a0d"],
Cell[24397, 579, 830, 24, 68, "Input",ExpressionUUID->"f51a69b0-42ba-4048-89bb-9b7617b08212"],
Cell[CellGroupData[{
Cell[25252, 607, 718, 20, 67, "Input",ExpressionUUID->"7205a734-6d5f-47db-b940-426988a4ac1f"],
Cell[25973, 629, 780, 13, 32, "Output",ExpressionUUID->"5f8d111b-9d9e-4c48-a8a5-903b790aa010"],
Cell[26756, 644, 1313, 27, 52, "Output",ExpressionUUID->"200b91ac-d391-455c-a530-debc192589ba"],
Cell[28072, 673, 765, 13, 32, "Output",ExpressionUUID->"e1ec29f9-afa5-454e-b2f2-43c651c1d572"]
}, Open  ]],
Cell[28852, 689, 1059, 26, 67, "Input",ExpressionUUID->"2b9a8fde-b181-4d1b-b8aa-6c01b253e6a6"],
Cell[29914, 717, 1124, 27, 105, "Input",ExpressionUUID->"b416fce4-0807-4963-8e65-4fe71bae450d"],
Cell[31041, 746, 282, 6, 28, "Input",ExpressionUUID->"337a153a-fbc0-416f-a8b9-5999b8a7a651"],
Cell[31326, 754, 318, 7, 28, "Input",ExpressionUUID->"33d126f6-aa91-4502-a539-212de337ab56"],
Cell[31647, 763, 736, 21, 48, "Input",ExpressionUUID->"1c5fee72-f767-42be-a47d-218e6c642e45"],
Cell[32386, 786, 3290, 81, 219, "Input",ExpressionUUID->"fe9344e5-4ce2-4ae6-a90c-571943839c5f"],
Cell[35679, 869, 2545, 65, 181, "Input",ExpressionUUID->"c4025e7e-0a2d-4e3d-83e6-c282ca419b9f"],
Cell[38227, 936, 1734, 43, 67, "Input",ExpressionUUID->"f7dfc850-2e26-4718-9386-f2c4055dc05c"],
Cell[CellGroupData[{
Cell[39986, 983, 383, 8, 28, "Input",ExpressionUUID->"dc48650f-16cd-48f8-9e2f-1be1815d70d8"],
Cell[40372, 993, 1576, 24, 52, "Output",ExpressionUUID->"81c1ce68-17ad-4876-90a1-00ed00d3e059"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41985, 1022, 1026, 23, 48, "Input",ExpressionUUID->"fa0ddfc8-cc09-4c12-a711-242e6202862d"],
Cell[43014, 1047, 2350, 46, 52, "Output",ExpressionUUID->"263728ee-b275-417a-9518-b1a77ac2bb40"]
}, Open  ]],
Cell[45379, 1096, 168, 2, 48, "Input",ExpressionUUID->"c9e3ea6b-98db-4148-82df-f66c98fd4b16"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45584, 1103, 1648, 23, 76, "Subsubsection",ExpressionUUID->"cc7b2c35-4047-4755-b8e1-af3c3244fce4"],
Cell[CellGroupData[{
Cell[47257, 1130, 2072, 56, 143, "Input",ExpressionUUID->"14aad255-5d7f-4512-a6d0-e34da3bc4949"],
Cell[49332, 1188, 1001, 16, 32, "Output",ExpressionUUID->"abb75991-f9cc-4998-aa26-2ee56ec25fb9"],
Cell[50336, 1206, 3235, 79, 90, "Output",ExpressionUUID->"239a20e3-5d28-46b5-93d8-8b59c2c1b754"],
Cell[53574, 1287, 1336, 26, 32, "Output",ExpressionUUID->"33635032-9631-4fe0-9e5a-e2b4e7e9f519"]
}, Open  ]],
Cell[54925, 1316, 909, 24, 67, "Input",ExpressionUUID->"a296a15c-5e6e-48b7-8ab2-795b9545b628"],
Cell[55837, 1342, 925, 25, 86, "Input",ExpressionUUID->"b16b77ff-dda6-4e73-bad0-b9d996c7dd56"],
Cell[56765, 1369, 377, 8, 28, "Input",ExpressionUUID->"82a2f875-2f12-4eec-b0f3-a742210acc81"],
Cell[57145, 1379, 253, 6, 28, "Input",ExpressionUUID->"9a3c4801-30ef-4653-aa97-a2314c168b28"],
Cell[57401, 1387, 711, 21, 48, "Input",ExpressionUUID->"123224bb-b579-4d01-ab1c-46046231f495"],
Cell[58115, 1410, 2476, 64, 181, "Input",ExpressionUUID->"dad89056-cb6b-4395-b6e7-a3c692a0efcf"],
Cell[60594, 1476, 2545, 66, 200, "Input",ExpressionUUID->"3d9e5946-4af5-4d1a-ba54-9b7853e2c767"],
Cell[63142, 1544, 1202, 36, 67, "Input",ExpressionUUID->"7489b470-0a1a-4303-b8fd-d3e63e8603d5"],
Cell[CellGroupData[{
Cell[64369, 1584, 385, 8, 28, "Input",ExpressionUUID->"688fe728-379d-400d-85ae-687b0ae94f34"],
Cell[64757, 1594, 1098, 17, 52, "Output",ExpressionUUID->"c5f0ec39-ef8f-43db-8031-e98e391e3701"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65892, 1616, 605, 15, 28, "Input",ExpressionUUID->"b9de42f1-dda8-4e50-959c-ee6d506d7009"],
Cell[66500, 1633, 2854, 78, 90, "Output",ExpressionUUID->"347b1abf-509e-4992-b1dc-035e3cb51a47"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69391, 1716, 1300, 32, 143, "Input",ExpressionUUID->"d7b04e4a-6c51-4637-9216-78b5a00d93a9"],
Cell[70694, 1750, 1148, 29, 52, "Output",ExpressionUUID->"649e53ae-64ee-49bc-93f2-38e8b1a35c60"]
}, Open  ]]
}, Open  ]]
}
]
*)

