(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     67163,       1689]
NotebookOptionsPosition[     61170,       1592]
NotebookOutlinePosition[     61616,       1609]
CellTagsIndexPosition[     61573,       1606]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["settings", "Section",
 CellChangeTimes->{{3.8416688317273965`*^9, 
  3.8416688378857746`*^9}},ExpressionUUID->"adedea70-c332-4e36-a7ef-\
9aeb958a147d"],

Cell[CellGroupData[{

Cell["functions", "Subsection",
 CellChangeTimes->{{3.841667359970975*^9, 3.841667364086259*^9}, {
  3.8416675921813326`*^9, 
  3.841667593030175*^9}},ExpressionUUID->"7c147572-7bd2-4554-bc4f-\
1e0bce9e3d38"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getVarianteTwoArg", "=", 
   RowBox[{
    RowBox[{"RandomVariate", "@", 
     RowBox[{"MultinomialDistribution", "[", 
      RowBox[{"#1", ",", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{
         RowBox[{"1", "/", "#2"}], ",", "#2"}], "]"}]}], "]"}]}], "&"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellLabel->"In[1]:=",ExpressionUUID->"898d947d-9e30-466e-92ba-087fda760225"]
}, Closed]],

Cell[CellGroupData[{

Cell["initial parameters", "Subsection",
 CellChangeTimes->{{3.841667359970975*^9, 
  3.8416673772366295`*^9}},ExpressionUUID->"c9c1cbf4-7af8-49d8-b2dd-\
0bd09456f321"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"numberOfContainers", "=", "8"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "\:043a\:043e\:043b\:0438\:0447\:0435\:0441\:0442\:0432\:043e", " ", 
    "\:043a\:043e\:043d\:0442\:0435\:0439\:043d\:0435\:0440\:043e\:0432"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numberOfVehicles", "=", "2"}], ";", 
  RowBox[{"(*", 
   RowBox[{
   "\:043a\:043e\:043b\:0438\:0447\:0435\:0441\:0442\:0432\:043e", " ", 
    "\:043c\:0430\:0448\:0438\:043d"}], "*)"}], "\n", 
  RowBox[{"numberOfStacks", "=", "4"}], ";", 
  RowBox[{"(*", 
   RowBox[{
   "\:043a\:043e\:043b\:0438\:0447\:0435\:0441\:0442\:0432\:043e", " ", 
    "\:0441\:0442\:0435\:043a\:043e\:0432"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.841749944016903*^9, 3.841749955777583*^9}, {
   3.841757733179845*^9, 3.841757736652732*^9}, {3.8417613896681256`*^9, 
   3.8417613905411367`*^9}, {3.841774277466235*^9, 3.841774277698101*^9}, {
   3.8417749300816746`*^9, 3.841774933962788*^9}, {3.8417759220339756`*^9, 
   3.8417759225836945`*^9}, {3.841858940328623*^9, 3.841858950304053*^9}, {
   3.844866366340249*^9, 3.8448663938504877`*^9}, {3.844943417156592*^9, 
   3.8449434218791823`*^9}, {3.844947722448515*^9, 3.8449477399481487`*^9}, 
   3.8449480256778197`*^9, 3.8449613873547087`*^9, {3.8449619249947405`*^9, 
   3.844961925317175*^9}, {3.8449688474776955`*^9, 3.8449688499730244`*^9}, {
   3.8449689538037953`*^9, 3.8449689556988583`*^9}, 3.844969118297182*^9, 
   3.844969157969561*^9, {3.8449700754509597`*^9, 3.8449701032491703`*^9}, {
   3.8449733863000607`*^9, 3.844973387671342*^9}, 3.8449768298363867`*^9, {
   3.8449769825686183`*^9, 3.8449769908335333`*^9}, {3.8449774026102853`*^9, 
   3.84497744195863*^9}, {3.844977475102981*^9, 3.8449774788712454`*^9}, {
   3.8449775287101583`*^9, 3.844977545410017*^9}, {3.8449777025869036`*^9, 
   3.8449777049326715`*^9}, {3.8449788494066195`*^9, 
   3.8449788518528767`*^9}, {3.8449797631141434`*^9, 3.84497976645195*^9}, {
   3.8449798046476555`*^9, 3.844979805023653*^9}, {3.844979866580738*^9, 
   3.8449798675568247`*^9}, {3.8449806724067016`*^9, 3.8449806730147357`*^9}, 
   3.8449809735607014`*^9, 3.845004669788228*^9, {3.8450076110369277`*^9, 
   3.8450076131150465`*^9}, {3.845007800924734*^9, 3.845007801455968*^9}, {
   3.8450084068531427`*^9, 3.845008411136854*^9}, {3.8450087474521933`*^9, 
   3.845008749953371*^9}, {3.845009809550955*^9, 3.8450098141673717`*^9}, {
   3.84501011087064*^9, 3.8450101111987963`*^9}, {3.845010399498201*^9, 
   3.8450104001009035`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"54f28b64-1408-46e0-b210-f3fcc250739b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Epsilon]", "=", "0.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"shareOfPairsBlocks", "=", "0.05"}], ";"}]}], "Input",
 CellChangeTimes->{{3.841753083429649*^9, 3.8417530946511955`*^9}, 
   3.8417716309491663`*^9, {3.841774304342889*^9, 3.8417743335809937`*^9}, 
   3.8417761738613253`*^9, {3.8417765333928146`*^9, 3.8417765342127495`*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"6c0fb735-492d-4934-9148-7b54c14a582a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["generate initial data", "Section",
 CellChangeTimes->{{3.8416688317273965`*^9, 3.841668846756056*^9}, 
   3.8418345539118476`*^9},ExpressionUUID->"8a679f96-9565-4f54-b540-\
80b6fd95e0d8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"vertices1", "=", 
    RowBox[{"Range", "@", "numberOfContainers"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "\:043c\:043d\:043e\:0436\:0435\:0441\:0442\:0432\:043e", " ", 
    "\:0432\:0435\:0440\:0448\:0438\:043d", " ", "V1"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"vertices2", "=", 
    RowBox[{"vertices1", "+", "numberOfContainers"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "\:043c\:043d\:043e\:0436\:0435\:0441\:0442\:0432\:043e", " ", 
    "\:0432\:0435\:0440\:0448\:0438\:043d", " ", "V2"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.8417499614491353`*^9, 3.84174998363239*^9}, 
   3.8417500267217865`*^9, 3.841750275067046*^9, 3.8417742254655485`*^9, {
   3.8448664256789837`*^9, 3.8448664470613174`*^9}, {3.8449699062946205`*^9, 
   3.8449699077032804`*^9}, {3.844971502415697*^9, 3.844971506248044*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"c37b5b94-a28c-48bb-b561-528e84873399"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"pointsVertices1", ",", "pointsVertices2"}], "}"}], "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "5"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"numberOfContainers", ",", "2"}], "}"}]}], "]"}], ",", "2"}],
      "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "\:043d\:0430\:0447\:0430\:043b\:044c\:043d\:043e\:0435", " ", "\:0438", 
     " ", "\:043a\:043e\:043d\:0435\:0447\:043d\:043e\:0435", " ", 
     "\:043f\:043e\:043b\:043e\:0436\:0435\:043d\:0438\:0435", " ", 
     "\:043a\:043e\:043d\:0442\:0435\:0439\:043d\:0435\:0440\:043e\:0432"}], 
    ",", " ", 
    RowBox[{
    "\:0441\:043b\:0443\:0447\:0430\:0439\:043d\:044b\:0435", " ", 
     "\:043f\:043e\:0437\:0438\:0446\:0438\:0438", " ", "\:043d\:0430", " ", 
     "\:043f\:043b\:043e\:0441\:043a\:043e\:0441\:0442\:0438"}]}], 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"distanceMatrix", "=", 
    RowBox[{"DistanceMatrix", "[", 
     RowBox[{"pointsVertices1", ",", "pointsVertices2"}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "\:0432\:0440\:0435\:043c\:0435\:043d\:043d\:044b\:0435", " ", 
    "\:0437\:0430\:0442\:0440\:0430\:0442\:044b", " ", "\:043d\:0430", " ", 
    "\:043f\:0435\:0440\:0435\:043c\:0435\:0449\:0435\:043d\:0438\:0435", " ",
     "\:043c\:0435\:0436\:0434\:0443", " ", 
    "\:0441\:043b\:043e\:044f\:043c\:0438"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.84175004943157*^9, 3.8417501062037425`*^9}, {
   3.841750144539324*^9, 3.8417501494402075`*^9}, {3.841757837377142*^9, 
   3.8417578380472965`*^9}, 3.8417742642471633`*^9, {3.8448664721694603`*^9, 
   3.8448664998047795`*^9}, {3.844866548331599*^9, 3.8448665656475735`*^9}, {
   3.8448666205993013`*^9, 3.844866668650463*^9}, {3.844947372374758*^9, 
   3.8449473863204603`*^9}, {3.844947468042585*^9, 3.8449474701951056`*^9}, {
   3.844969914594581*^9, 3.8449699155846577`*^9}, {3.8449715075053716`*^9, 
   3.844971508157489*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"659aed43-2131-4ae0-bae0-706556ac51fb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Delta]1", "=", 
   RowBox[{"\[Delta]2", "=", 
    RowBox[{"Ceiling", "@", 
     RowBox[{"Mean", "@", 
      RowBox[{"Flatten", "@", "distanceMatrix"}]}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8417523081462045`*^9, 3.841752334062422*^9}, {
   3.8417719366601143`*^9, 3.8417719382647533`*^9}, 3.8449699167650824`*^9, 
   3.8449715098823833`*^9},
 CellLabel->"In[10]:=",ExpressionUUID->"b798c6ee-a541-444e-a42e-f00ce1d0e13c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"outArcs", "=", 
    RowBox[{"MapThread", "[", 
     RowBox[{"DirectedEdge", ",", 
      RowBox[{"{", 
       RowBox[{"vertices1", ",", "vertices2"}], "}"}]}], "]"}]}], " ", ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "\:0438\:0441\:0445\:043e\:0434\:044f\:0449\:0438\:0435", " ", 
    "\:0432\:0435\:0440\:0448\:0438\:043d\:044b", " ", 
    "\:043f\:0435\:0440\:0432\:043e\:0433\:043e", " ", 
    "\:0441\:043b\:043e\:044f"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"inArcs", "=", 
    RowBox[{"DeleteCases", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{"Outer", "[", 
        RowBox[{"DirectedEdge", ",", "vertices2", ",", "vertices1"}], "]"}], 
       "]"}], ",", 
      RowBox[{
       RowBox[{"i_", "\[DirectedEdge]", "j_"}], "/;", 
       RowBox[{
        RowBox[{"i", "-", "numberOfContainers"}], "==", "j"}]}]}], "]"}]}], 
   ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "\:0432\:0445\:043e\:0434\:044f\:0449\:0438\:0435", " ", 
    "\:0432\:0435\:0440\:0448\:0438\:043d\:044b", " ", 
    "\:043f\:0435\:0440\:0432\:043e\:0433\:043e", " ", 
    "\:0441\:043b\:043e\:044f"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"startArcs", "=", 
    RowBox[{"Thread", "[", 
     RowBox[{"DirectedEdge", "[", 
      RowBox[{"0", ",", "vertices1"}], "]"}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "\:0432\:044b\:0435\:0437\:0434", " ", "\:0438\:0437", " ", "0", " ", 
    "\:0432\:0435\:0440\:0448\:0438\:043d\:044b"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"endArcs", "=", 
    RowBox[{"Thread", "[", 
     RowBox[{"DirectedEdge", "[", 
      RowBox[{"vertices2", ",", 
       RowBox[{
        RowBox[{"2", "numberOfContainers"}], "+", "1"}]}], "]"}], "]"}]}], 
   " ", ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "\:0432\:044a\:0435\:0437\:0434", " ", "\:0432", " ", 
     "\:0432\:0435\:0440\:0448\:0438\:043d\:0443", " ", "2", "n"}], "+", 
    "1"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"arcs", "=", 
    RowBox[{"Join", "[", 
     RowBox[{"startArcs", ",", "inArcs", ",", "outArcs", ",", "endArcs"}], 
     "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "\:043c\:043d\:043e\:0436\:0435\:0441\:0442\:0432\:043e", " ", 
    "\:0432\:0441\:0435\:0445", " ", "\:0434\:0443\:0433", " ", "\:0432", " ",
     "\:0433\:0440\:0430\:0444\:0435"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.8417502796275296`*^9, 3.841750299074192*^9}, {
   3.8417510622686987`*^9, 3.8417510729532213`*^9}, 3.8417742706530547`*^9, {
   3.844866692899384*^9, 3.844866786266993*^9}, 3.8449515800163574`*^9, {
   3.844961556014741*^9, 3.8449615588623667`*^9}, 3.8449618463878555`*^9, {
   3.8449699178962293`*^9, 3.8449699232955112`*^9}, {3.844971512012993*^9, 
   3.8449715160258865`*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"90d267af-5a85-46e8-8a13-e692930ecd1a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"stacks", "=", 
    RowBox[{"TakeList", "[", 
     RowBox[{
      RowBox[{"RandomSample", "@", "vertices1"}], ",", 
      RowBox[{"getVarianteTwoArg", "[", 
       RowBox[{"numberOfContainers", ",", "numberOfStacks"}], "]"}]}], 
     "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "\:0440\:0430\:0437\:0431\:0438\:0442\:0438\:0435", " ", 
    "\:0432\:0435\:0440\:0448\:0438\:043d", " ", "\:043d\:0430", " ", 
    "\:0441\:0442\:0435\:043a\:0438"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.841751860917306*^9, 3.841751889921096*^9}, {
   3.8417520151053104`*^9, 3.841752044033165*^9}, {3.841774164030654*^9, 
   3.8417741726075363`*^9}, {3.8448668063873014`*^9, 3.8448668154625387`*^9}, 
   3.8449699252008114`*^9, 3.8449715193398857`*^9},
 CellLabel->"In[16]:=",ExpressionUUID->"c71596d3-cdf6-4b94-9141-528583815d96"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"pairsVertices1", ",", "pairsVertices2"}], "}"}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"RandomSample", "[", 
         RowBox[{"#", ",", 
          RowBox[{"Floor", "[", 
           RowBox[{"shareOfPairsBlocks", " ", 
            RowBox[{"Length", "@", "#"}]}], "]"}]}], "]"}], "&"}], "@", 
       RowBox[{"Subsets", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], "&"}], "/@", 
     RowBox[{"{", 
      RowBox[{"vertices1", ",", "vertices2"}], "}"}]}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "\:043c\:043d\:043e\:0436\:0435\:0441\:0442\:0432\:0430", " ", "PV1"}], 
    ",", "PV2"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.841752161348873*^9, 3.8417522993883004`*^9}, {
   3.841758654964589*^9, 3.841758655861944*^9}, {3.841774315279356*^9, 
   3.8417743405699205`*^9}, {3.844866823814375*^9, 3.8448668542223563`*^9}, {
   3.8449699271032095`*^9, 3.8449699564846544`*^9}, 3.844971521051505*^9, 
   3.8449788585962143`*^9, {3.8450097969990997`*^9, 3.845009799745947*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"f802a249-8cd3-4265-aa58-b0f83100189f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"K", "=", 
   RowBox[{"numberOfVehicles", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Total", "[", 
       RowBox[{"Max", "/@", "distanceMatrix"}], "]"}], "+", 
      RowBox[{"Total", "[", 
       RowBox[{
        RowBox[{"Max", "/@", "distanceMatrix"}], "\[Transpose]"}], "]"}]}], 
     ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8417765432233624`*^9, 3.8417766752706747`*^9}, 
   3.8449699286117663`*^9, 3.8449715240988483`*^9},
 CellLabel->"In[18]:=",ExpressionUUID->"d8b7e5c6-6f1c-47de-80e4-2a93035f73a0"],

Cell[CellGroupData[{

Cell["\:041f\:0435\:0440\:0435\:043c\:0435\:043d\:043d\:044b\:0435", \
"Subsubsection",
 CellChangeTimes->{{3.844959803216031*^9, 
  3.8449598193425474`*^9}},ExpressionUUID->"38d65518-c522-40ca-915c-\
10bc0d72f0e0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"varsX2", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"x", "[", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], "/@", 
     RowBox[{"Join", "[", 
      RowBox[{"inArcs", ",", "outArcs"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varsX3", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"Flatten", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Sort", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "k"}], "]"}], "&"}], "/@", 
         RowBox[{"Join", "[", 
          RowBox[{"startArcs", ",", "endArcs"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "numberOfVehicles"}], "}"}]}], "]"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varsX", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"varsX2", ",", "varsX3"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.844943392507962*^9, 3.8449433961433225`*^9}, {
  3.844943571697197*^9, 3.844943649598419*^9}, {3.8449437462972045`*^9, 
  3.8449437514628143`*^9}, {3.844958853941999*^9, 3.844958889047764*^9}, {
  3.8449589549658155`*^9, 3.8449589626347523`*^9}, {3.8449591912747884`*^9, 
  3.8449592211732826`*^9}, {3.844959253077159*^9, 3.8449593540060606`*^9}, {
  3.8449594409385014`*^9, 3.8449594483418436`*^9}, {3.844959480132835*^9, 
  3.8449594889036827`*^9}, {3.8449604189857883`*^9, 3.8449604652905793`*^9}, {
  3.844961564698614*^9, 3.844961568867564*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"9cb68c5e-7de9-46f7-bb92-d6b5bb183cd4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"varsU1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"u", "[", "#", "]"}], "&"}], "/@", 
    RowBox[{"Join", "[", 
     RowBox[{"vertices1", ",", "vertices2"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lstu2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"u", "[", "#", "]"}], "&"}], "/@", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{
       RowBox[{"2", "*", "numberOfContainers"}], "+", "1"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varsU2", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"lstu2", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", "k"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "@", "lstu2"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "numberOfVehicles"}], "}"}]}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varsU", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"varsU1", ",", 
     RowBox[{"Flatten", "@", "varsU2"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.8449445728152742`*^9, {3.8449446775327277`*^9, 3.8449447277965713`*^9}, {
   3.844944971002643*^9, 3.8449449728691587`*^9}, 3.844946266991599*^9, {
   3.8449585722513027`*^9, 3.8449586428063684`*^9}, {3.844958938000533*^9, 
   3.8449589891045284`*^9}, {3.8449594957957845`*^9, 3.844959522496728*^9}, {
   3.8449660214279284`*^9, 3.8449660543479023`*^9}, 3.844971536877658*^9},
 CellLabel->"In[22]:=",ExpressionUUID->"59484561-1f09-4d19-9255-21143ae8ffdc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"varsy1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"y1", "[", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], "/@", 
    "pairsVertices1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varsy2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"y2", "[", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "&"}], "/@", 
    "pairsVertices2"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8449626735622034`*^9, 3.8449626957385273`*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"6cedea7f-f6ca-429f-8e28-e6af610074d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vars", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"varsX", ",", "varsU", ",", "varsy1", ",", "varsy2", ",", 
     RowBox[{"{", "umax", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8449448820854607`*^9, 3.8449448921267414`*^9}, {
   3.8449449761485147`*^9, 3.8449449849012218`*^9}, {3.8449491216068707`*^9, 
   3.8449491281940784`*^9}, 3.844958913111017*^9, {3.844962687759465*^9, 
   3.84496269075906*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"e28cf248-a74e-455d-a8bd-9586f77ff54a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\:041a\:0440\:0438\:0442\:0435\:0440\:0438\:0438\:0438 \:043e\:043f\
\:0442\:0438\:043c\:0438\:0437\:0430\:0446\:0438\:0438", "Subsubsection",
 CellChangeTimes->{{3.8449598262651815`*^9, 
  3.8449598380409584`*^9}},ExpressionUUID->"d4667e9c-4565-4a50-bdf7-\
ba67f1722201"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"objFun1", "=", 
   RowBox[{"Total", "[", 
    RowBox[{
     RowBox[{"Last", "@", "varsU2"}], "-", 
     RowBox[{"First", "@", "varsU2"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"objFun2", "=", "umax"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.8449449319887424`*^9, {3.8449449968631372`*^9, 3.8449449984137735`*^9}, {
   3.844945034770564*^9, 3.84494507472217*^9}, {3.8449589504751644`*^9, 
   3.844958951456235*^9}, 3.8449589948794537`*^9, {3.8449591238554835`*^9, 
   3.84495912812122*^9}, 3.844959167637586*^9, {3.844959539972578*^9, 
   3.8449595907235875`*^9}, {3.8449597273500795`*^9, 
   3.8449597308591986`*^9}, {3.844968505197215*^9, 3.844968507641133*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"e8001e8b-6675-4406-a861-cea9dcef20b3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"weights", "=", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "0.5"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"objFun", "=", 
   RowBox[{"Dot", "[", 
    RowBox[{"weights", ",", 
     RowBox[{"{", 
      RowBox[{"objFun1", ",", "objFun2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c", "=", 
   RowBox[{"Last", "@", 
    RowBox[{"CoefficientArrays", "[", 
     RowBox[{"objFun", ",", "vars"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.844968478681222*^9, {3.8449685162766066`*^9, 3.844968532251086*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"b48e5d6e-1e13-49b0-9096-f07b61ab8ec2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\:041e\:0433\:0440\:0430\:043d\:0438\:0447\:0435\:043d\:0438\:044f", \
"Subsubsection",
 CellChangeTimes->{{3.844975879215784*^9, 3.8449758792470284`*^9}, 
   3.8449759430625563`*^9},ExpressionUUID->"c867dbfb-476a-4ebd-8dc2-\
14368aab28cf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"con1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Total", "[", 
      RowBox[{"Cases", "[", 
       RowBox[{"varsX2", ",", 
        RowBox[{"x", "[", 
         RowBox[{"i", ",", "_"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "vertices1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhs1", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"Length", "@", "con1"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8449759558307557`*^9, 3.8449759667779074`*^9}, {
  3.8449760466621604`*^9, 3.844976047405578*^9}, {3.8449763981521726`*^9, 
  3.8449764092881136`*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"5c05e95f-2130-4ff7-94e6-ce25aefe566b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"con2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Total", "[", 
      RowBox[{"Cases", "[", 
       RowBox[{"varsX3", ",", 
        RowBox[{"x", "[", 
         RowBox[{"0", ",", "_", ",", "k"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "numberOfVehicles"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhs2", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"Length", "@", "con2"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8449759787129335`*^9, 3.8449759823742723`*^9}, {
   3.8449760484224644`*^9, 3.8449760521177893`*^9}, 3.8449761281356316`*^9, 
   3.8449763129668636`*^9, 3.844976366502677*^9},
 CellLabel->"In[36]:=",ExpressionUUID->"13da95bb-e0de-423a-9c35-008e465c8601"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"con3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Total", "[", 
       RowBox[{"Cases", "[", 
        RowBox[{"varsX3", ",", 
         RowBox[{"x", "[", 
          RowBox[{"0", ",", "i", ",", "_"}], "]"}]}], "]"}], "]"}], "+", 
      RowBox[{"Total", "[", 
       RowBox[{"Cases", "[", 
        RowBox[{"varsX2", ",", 
         RowBox[{"x", "[", 
          RowBox[{"_", ",", "i"}], "]"}]}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "vertices1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhs3", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"Length", "@", "con3"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8449759841867633`*^9, 3.844975986053232*^9}, {
   3.844976053039663*^9, 3.844976053680297*^9}, 3.8449761562250576`*^9, 
   3.8449763839370832`*^9},
 CellLabel->"In[38]:=",ExpressionUUID->"a703b6a9-0c02-446d-b3bd-dca150945ed3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"con4", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Total", "[", 
       RowBox[{"Cases", "[", 
        RowBox[{"varsX3", ",", 
         RowBox[{"x", "[", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"2", "*", "numberOfContainers"}], "+", "1"}], ",", "_"}], 
          "]"}]}], "]"}], "]"}], "+", 
      RowBox[{"Total", "[", 
       RowBox[{"Cases", "[", 
        RowBox[{"varsX2", ",", 
         RowBox[{"x", "[", 
          RowBox[{"i", ",", "_"}], "]"}]}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "vertices2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhs4", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"Length", "@", "con4"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.84497598860553*^9, 3.844975990853978*^9}, {
   3.8449760544749937`*^9, 3.844976055124035*^9}, 3.8449762391914964`*^9, {
   3.844976459765506*^9, 3.844976465671736*^9}, 3.8449767984981227`*^9},
 CellLabel->"In[40]:=",ExpressionUUID->"a5fdcd41-45cc-4d7b-bd36-366589a358e9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"con5", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Total", "[", 
       RowBox[{"Cases", "[", 
        RowBox[{"varsX3", ",", 
         RowBox[{"x", "[", 
          RowBox[{"0", ",", "_", ",", "k"}], "]"}]}], "]"}], "]"}], "-", 
      RowBox[{"Total", "[", 
       RowBox[{"Cases", "[", 
        RowBox[{"varsX3", ",", 
         RowBox[{"x", "[", 
          RowBox[{"_", ",", 
           RowBox[{
            RowBox[{"2", "*", "numberOfContainers"}], "+", "1"}], ",", "k"}], 
          "]"}]}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "numberOfVehicles"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhs5", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"Length", "@", "con5"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.844975993039756*^9, 3.8449760087242284`*^9}, {
   3.844976056530281*^9, 3.844976057195589*^9}, {3.8449764848256497`*^9, 
   3.84497649216164*^9}, 3.844976801257897*^9},
 CellLabel->"In[42]:=",ExpressionUUID->"091f3405-7217-40fe-9119-3b847a95d97e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"con6", "=", 
   RowBox[{"umax", "-", 
    RowBox[{"Last", "@", "varsU2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhs6", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"Length", "@", "con6"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.84497599843262*^9, 3.844976010657498*^9}, {
  3.8449760578987117`*^9, 3.8449760583758326`*^9}, {3.844976099246365*^9, 
  3.844976104188179*^9}, {3.8449763441084414`*^9, 3.844976348983694*^9}, {
  3.844976413828148*^9, 3.844976414250044*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"50fecb20-e9fa-4d94-ba3f-c5ee0bd7fd45"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"con7", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"Flatten", "@", "varsU2"}], ",", 
         RowBox[{"u", "[", 
          RowBox[{"0", ",", "k"}], "]"}]}], "]"}], "-", 
       RowBox[{"K", "*", 
        RowBox[{"Total", "[", 
         RowBox[{"Cases", "[", 
          RowBox[{"varsX3", ",", 
           RowBox[{"x", "[", 
            RowBox[{"0", ",", "_", ",", "k"}], "]"}]}], "]"}], "]"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "numberOfVehicles"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhs7", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"Length", "@", "con7"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8449760114387484`*^9, 3.844976013345005*^9}, {
  3.8449760589227104`*^9, 3.8449760594383383`*^9}, {3.8449767825226264`*^9, 
  3.8449767921946573`*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"ea3bf0c8-cf19-4885-a495-08ffb525de79"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pairsOfPriorInStack", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Subsets", "[", 
        RowBox[{"#", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}], "&"}], "/@", "stacks"}], ",", 
     "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"con8", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"varsU1", ",", 
         RowBox[{"u", "[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], "-", 
       RowBox[{"Cases", "[", 
        RowBox[{"varsU1", ",", 
         RowBox[{"u", "[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}]}], "&"}], "/@", 
     "pairsOfPriorInStack"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhs8", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Delta]1", ",", "1"}], "}"}], ",", 
     RowBox[{"Length", "@", "con8"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8449760149229345`*^9, 3.844976015549077*^9}, {
  3.844976059884307*^9, 3.844976060321806*^9}, {3.844976517058142*^9, 
  3.8449765245532727`*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"d35bf43c-acb1-465f-89a6-151ae695d77e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"con9", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cases", "[", 
         RowBox[{"varsU1", ",", 
          RowBox[{"u", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], "+", 
       RowBox[{"Cases", "[", 
        RowBox[{"varsU1", ",", 
         RowBox[{"u", "[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}], "-", 
       RowBox[{"K", "*", 
        RowBox[{"Cases", "[", 
         RowBox[{"varsy1", ",", 
          RowBox[{"y1", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}]}], "&"}], "/@",
      "pairsVertices1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhs9", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "\[Delta]2"}], ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"Length", "@", "con9"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8449760165690784`*^9, 3.844976018131624*^9}, {
  3.8449760608277626`*^9, 3.8449760620621257`*^9}, {3.8449765632068663`*^9, 
  3.844976569592596*^9}, {3.8449774951858606`*^9, 3.8449775045414667`*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"d1d2a6b9-6662-4f45-bb8e-19a6d018407f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"con10", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"varsU1", ",", 
         RowBox[{"u", "[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], "-", 
       RowBox[{"Cases", "[", 
        RowBox[{"varsU1", ",", 
         RowBox[{"u", "[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}], "+", 
       RowBox[{"Cases", "[", 
        RowBox[{"varsy1", ",", 
         RowBox[{"y1", "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], "&"}], "/@", 
     "pairsVertices1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhs10", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"K", "-", "\[Delta]2"}], ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"Length", "@", "con10"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.844976022260681*^9, 3.844976024584057*^9}, {
   3.8449760625621243`*^9, 3.844976063046501*^9}, {3.844976579862935*^9, 
   3.8449765888150864`*^9}, 3.8449791766378984`*^9, 3.8449792412738657`*^9, {
   3.8449792717347174`*^9, 3.844979277692308*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"e4aa3fed-1d95-4433-9d01-9b2106388122"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"con11", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cases", "[", 
         RowBox[{"varsU1", ",", 
          RowBox[{"u", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], "+", 
       RowBox[{"Cases", "[", 
        RowBox[{"varsU1", ",", 
         RowBox[{"u", "[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}], "-", 
       RowBox[{"K", "*", 
        RowBox[{"Cases", "[", 
         RowBox[{"varsy2", ",", 
          RowBox[{"y2", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}]}], "&"}], "/@",
      "pairsVertices2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhs11", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "\[Delta]2"}], ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"Length", "@", "con11"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.844976026177924*^9, 3.844976027318551*^9}, {
  3.844976063530882*^9, 3.8449760642496233`*^9}, {3.844976613950638*^9, 
  3.8449766337666516`*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"21427704-b724-456d-9637-dda35c2ea5a0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"con12", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"varsU1", ",", 
         RowBox[{"u", "[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], "-", 
       RowBox[{"Cases", "[", 
        RowBox[{"varsU1", ",", 
         RowBox[{"u", "[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}], "+", 
       RowBox[{"Cases", "[", 
        RowBox[{"varsy2", ",", 
         RowBox[{"y2", "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}], "&"}], "/@", 
     "pairsVertices2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhs12", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"K", "-", "\[Delta]2"}], ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"Length", "@", "con12"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8449760279123144`*^9, 3.844976029131071*^9}, {
  3.844976065571375*^9, 3.8449760659932547`*^9}, {3.844976626551078*^9, 
  3.8449766316142855`*^9}, {3.844979260792308*^9, 3.8449792748922176`*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"66968f44-f7ea-40c1-baa5-57f669d0f78e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"con13", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cases", "[", 
         RowBox[{"varsU1", ",", 
          RowBox[{"u", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], "+", 
       RowBox[{"Cases", "[", 
        RowBox[{"varsU1", ",", 
         RowBox[{"u", "[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}], "-", 
       RowBox[{"K", "*", 
        RowBox[{"Cases", "[", 
         RowBox[{"varsX2", ",", 
          RowBox[{"x", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "]"}]}]}], "&"}], "/@", 
     RowBox[{"Join", "[", 
      RowBox[{"inArcs", ",", "outArcs"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhs13", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ">", "numberOfContainers"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"distanceMatrix", "[", 
            RowBox[{"[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", "numberOfContainers"}], 
            "]"}], "]"}], "-", "K"}], ",", "1"}], "}"}], ",", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ">", "numberOfContainers"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"distanceMatrix", "[", 
            RowBox[{"[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", "numberOfContainers"}], 
            "]"}], "]"}], "-", "K"}], ",", "1"}], "}"}]}], "]"}], "&"}], "/@", 
    RowBox[{"Join", "[", 
     RowBox[{"inArcs", ",", "outArcs"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.844976030226937*^9, 3.8449760321413856`*^9}, {
  3.8449760665088778`*^9, 3.8449760669776163`*^9}, {3.844976700633679*^9, 
  3.8449767044374228`*^9}, {3.8450075496739893`*^9, 3.845007551741626*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"97a3775b-4779-40b0-a65f-4548ac551bdd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"con14", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Cases", "[", 
           RowBox[{"varsU1", ",", 
            RowBox[{"u", "[", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], "+", 
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"Flatten", "@", "varsU2"}], ",", 
           RowBox[{"u", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"2", "*", "numberOfContainers"}], "+", "1"}], ",", 
             "k"}], "]"}]}], "]"}], "-", 
         RowBox[{"K", "*", 
          RowBox[{"Cases", "[", 
           RowBox[{"varsX3", ",", 
            RowBox[{"x", "[", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"2", "*", "numberOfContainers"}], "+", "1"}], ",", 
              "k"}], "]"}]}], "]"}]}]}], "&"}], "/@", "endArcs"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "numberOfVehicles"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhs14", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "K"}], ",", "1"}], "}"}], ",", 
     RowBox[{"Length", "@", "con14"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8449760345007596`*^9, 3.844976036767284*^9}, {
  3.8449760673994856`*^9, 3.844976067805733*^9}, {3.8449767235473433`*^9, 
  3.844976731985976*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"7d974ad0-ef4e-4242-9397-c76cee2d47e2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"con15", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{"varsU1", ",", 
           RowBox[{"u", "[", 
            RowBox[{"#", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}], "-", 
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"Flatten", "@", "varsU2"}], ",", 
           RowBox[{"u", "[", 
            RowBox[{"0", ",", "k"}], "]"}]}], "]"}], "-", 
         RowBox[{"K", "*", 
          RowBox[{"Cases", "[", 
           RowBox[{"varsX3", ",", 
            RowBox[{"x", "[", 
             RowBox[{"0", ",", 
              RowBox[{"#", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "k"}], "]"}]}], "]"}]}]}],
         "&"}], "/@", "startArcs"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "numberOfVehicles"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhs15", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "K"}], ",", "1"}], "}"}], ",", 
     RowBox[{"Length", "@", "con15"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.844976037814156*^9, 3.8449760696338835`*^9}, {
  3.8449767439132166`*^9, 3.8449767473960238`*^9}, {3.844976815784238*^9, 
  3.844976816143611*^9}, {3.8449797550215206`*^9, 3.8449797561774282`*^9}, {
  3.845007494269455*^9, 3.845007497152796*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"2dd3c1f8-84b6-4717-a27e-a28249571f94"]
}, Open  ]],

Cell[CellGroupData[{

Cell["LinearProgramming", "Subsection",
 CellChangeTimes->{{3.8449692431946564`*^9, 
  3.8449692502646165`*^9}},ExpressionUUID->"126d93b4-eb08-41d2-9526-\
b7415aed06db"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lu", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"ConstantArray", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"Length", "@", "varsX"}]}], "]"}], ",", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "K"}], "}"}], ",", 
       RowBox[{"Length", "@", 
        RowBox[{"Flatten", "[", "varsU", "]"}]}]}], "]"}], ",", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"Length", "@", "varsy1"}]}], "]"}], ",", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"Length", "@", "varsy2"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"0", ",", "K"}], "}"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"domain", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"ConstantArray", "[", 
      RowBox[{"Integers", ",", 
       RowBox[{"Length", "@", "varsX"}]}], "]"}], ",", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"Reals", ",", 
       RowBox[{"Length", "@", 
        RowBox[{"Flatten", "[", "varsU", "]"}]}]}], "]"}], ",", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"Integers", ",", 
       RowBox[{"Length", "@", "varsy1"}]}], "]"}], ",", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"Integers", ",", 
       RowBox[{"Length", "@", "varsy2"}]}], "]"}], ",", 
     RowBox[{"{", "Reals", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matr", "=", 
   RowBox[{"Last", "@", 
    RowBox[{"CoefficientArrays", "[", 
     RowBox[{
      RowBox[{"Join", "[", 
       RowBox[{
       "con1", ",", "con2", ",", "con3", ",", "con4", ",", "con5", ",", 
        "con6", ",", "con7", ",", "con8", ",", "con9", ",", "con10", ",", 
        "con11", ",", "con12", ",", "con13", ",", "con14", ",", "con15"}], 
       "]"}], ",", "vars"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bb", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
    "rhs1", ",", "rhs2", ",", "rhs3", ",", "rhs4", ",", "rhs5", ",", "rhs6", 
     ",", "rhs7", ",", "rhs8", ",", "rhs9", ",", "rhs10", ",", "rhs11", ",", 
     "rhs12", ",", "rhs13", ",", "rhs14", ",", "rhs15"}], "]"}]}], 
  ";"}]}], "Input",
 CellLabel->"In[65]:=",ExpressionUUID->"818f1568-b6fb-4dff-a288-af81dca4db11"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol", "=", 
  RowBox[{"LinearProgramming", "[", 
   RowBox[{"c", ",", "matr", ",", "bb", ",", "lu", ",", "domain"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{3.844968569065962*^9, 3.844969100518446*^9, 
  3.8450046789151573`*^9},
 CellLabel->"In[69]:=",ExpressionUUID->"7463d2b7-7815-4e4f-95b6-a361c99a1a76"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
   "1", ",", "1", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", 
   ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0.`", ",", 
   "11.143630578948045`", ",", "11.548363888588375`", ",", 
   "7.176562638822655`", ",", "3.`", ",", "0.`", ",", "4.832454878575802`", 
   ",", "7.167759779919516`", ",", "0.9296896970677241`", ",", 
   "12.615898559350056`", ",", "13.558592213488293`", ",", 
   "9.71758434715967`", ",", "5.344211223253777`", ",", "3.3733767040595564`",
    ",", "7.11979428300372`", ",", "11.41901993878401`", ",", "0.`", ",", 
   "0.`", ",", "12.615898559350057`", ",", "13.558592213488295`", ",", "1", 
   ",", "1", ",", "13.558592213488295`"}], "}"}]], "Output",
 CellChangeTimes->{{3.8449691011160507`*^9, 3.844969165900091*^9}, 
   3.84496938369775*^9, 3.8449699374595647`*^9, 3.8449699686463566`*^9, {
   3.844970078149876*^9, 3.844970106423764*^9}, 3.844971548680656*^9, 
   3.844971680725349*^9, 3.844973154501676*^9, 3.8449733922760572`*^9, {
   3.844976823041195*^9, 3.8449768317113595`*^9}, 3.8449768920393977`*^9, {
   3.8449769453764114`*^9, 3.8449769948292847`*^9}, {3.844977408738412*^9, 
   3.8449774478297553`*^9}, {3.844977480945341*^9, 3.8449775352149773`*^9}, 
   3.8449775840281286`*^9, 3.8449777251610537`*^9, {3.8449788427315817`*^9, 
   3.844978862027099*^9}, 3.844979815053598*^9, 3.8449798597838135`*^9, 
   3.8449799047795877`*^9, 3.8449810402836895`*^9, 3.8450048047136555`*^9, 
   3.845007651867622*^9, 3.845007702008305*^9, 3.8450088428881903`*^9, 
   3.845010477356355*^9},
 CellLabel->"Out[69]=",ExpressionUUID->"70b4636a-f896-4230-aa58-0a2b9ae1f374"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"x2", "=", 
  RowBox[{"Sort", "[", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"sol", "[", 
       RowBox[{"[", 
        RowBox[{";;", 
         RowBox[{"Length", "@", "varsX2"}]}], "]"}], "]"}], "*", "varsX2"}], 
     ",", "0"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8449799420637054`*^9, 3.844980019463208*^9}, {
  3.844980053144613*^9, 3.844980069537368*^9}, {3.8449803921630774`*^9, 
  3.8449803987369857`*^9}, {3.8449804420951433`*^9, 3.8449804431436243`*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"76f80471-16c2-4f58-bbbe-00a91fd494ee"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"x", "[", 
    RowBox[{"1", ",", "9"}], "]"}], ",", 
   RowBox[{"x", "[", 
    RowBox[{"2", ",", "10"}], "]"}], ",", 
   RowBox[{"x", "[", 
    RowBox[{"3", ",", "11"}], "]"}], ",", 
   RowBox[{"x", "[", 
    RowBox[{"4", ",", "12"}], "]"}], ",", 
   RowBox[{"x", "[", 
    RowBox[{"5", ",", "13"}], "]"}], ",", 
   RowBox[{"x", "[", 
    RowBox[{"6", ",", "14"}], "]"}], ",", 
   RowBox[{"x", "[", 
    RowBox[{"7", ",", "15"}], "]"}], ",", 
   RowBox[{"x", "[", 
    RowBox[{"8", ",", "16"}], "]"}], ",", 
   RowBox[{"x", "[", 
    RowBox[{"9", ",", "5"}], "]"}], ",", 
   RowBox[{"x", "[", 
    RowBox[{"12", ",", "2"}], "]"}], ",", 
   RowBox[{"x", "[", 
    RowBox[{"13", ",", "8"}], "]"}], ",", 
   RowBox[{"x", "[", 
    RowBox[{"14", ",", "7"}], "]"}], ",", 
   RowBox[{"x", "[", 
    RowBox[{"15", ",", "4"}], "]"}], ",", 
   RowBox[{"x", "[", 
    RowBox[{"16", ",", "3"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.844979966444872*^9, 3.84498001997528*^9}, {
   3.844980058773774*^9, 3.8449800702573752`*^9}, 3.844980399168971*^9, 
   3.8449804435676036`*^9, 3.8449810403316927`*^9, 3.8450048048086967`*^9, 
   3.8450077021489162`*^9, 3.8450088429506855`*^9, 3.845010477403719*^9},
 CellLabel->"Out[70]=",ExpressionUUID->"c01ed00c-6943-4130-a39f-24cc50782ba7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"x3", "=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"sol", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "@", "varsX2"}], "+", "1"}], ";;", 
         RowBox[{
          RowBox[{"Length", "@", "varsX2"}], "+", 
          RowBox[{"Length", "@", "varsX3"}]}]}], "]"}], "]"}], "*", 
      "varsX3"}], ",", "0"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"GroupBy", "[", 
  RowBox[{"x3", ",", "Last"}], "]"}]}], "Input",
 CellChangeTimes->{{3.8449801190186663`*^9, 3.844980376170164*^9}, {
  3.844980446934441*^9, 3.8449804477172318`*^9}, {3.844980523864455*^9, 
  3.8449805552741613`*^9}, {3.8450077569387217`*^9, 3.845007757298122*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"86363692-6775-4c88-a82d-17f56378ad7b"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"2", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", "[", 
       RowBox[{"0", ",", "1", ",", "2"}], "]"}], ",", 
      RowBox[{"x", "[", 
       RowBox[{"11", ",", "17", ",", "2"}], "]"}]}], "}"}]}], ",", 
   RowBox[{"1", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", "[", 
       RowBox[{"0", ",", "6", ",", "1"}], "]"}], ",", 
      RowBox[{"x", "[", 
       RowBox[{"10", ",", "17", ",", "1"}], "]"}]}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.845008842966322*^9, 3.845010477434492*^9},
 CellLabel->"Out[72]=",ExpressionUUID->"22ac4c3e-409e-4aa4-8906-75b7552a6fcf"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"vert", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", "x2"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], "/@", "x3"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.844980566608158*^9, 3.844980593900217*^9}, 
   3.84498065676752*^9},
 CellLabel->"In[73]:=",ExpressionUUID->"d2dc429f-a649-4945-acc3-a8e223187db1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Graph", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "\[DirectedEdge]", 
      RowBox[{"#", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "&"}], "/@", "vert"}], ",", 
   RowBox[{"VertexLabels", "\[Rule]", "\"\<Name\>\""}]}], "]"}]], "Input",
 CellLabel->"In[74]:=",ExpressionUUID->"13d50de8-3f53-4487-99c8-d99a9f617c60"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{1, 9, 2, 10, 3, 11, 4, 12, 5, 13, 6, 14, 7, 15, 8, 16, 0, 
      17}, {{{1, 2}, {3, 4}, {5, 6}, {7, 8}, {9, 10}, {11, 12}, {13, 14}, {15,
        16}, {2, 9}, {8, 3}, {10, 15}, {12, 13}, {14, 7}, {16, 5}, {17, 1}, {
       17, 11}, {4, 18}, {6, 18}}, Null}, {VertexLabels -> {"Name"}}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[Medium], 
        ArrowBox[{{0., 8.}, {0., 7.}}, 0.061894273127753294`], 
        ArrowBox[{{0., 7.}, {0., 6.}}, 0.061894273127753294`], 
        ArrowBox[{{-1., 2.}, {-1., 1.}}, 0.061894273127753294`], 
        ArrowBox[{{-1., 1.}, {-1., 0.}}, 0.061894273127753294`], 
        ArrowBox[{{0., 2.}, {0., 1.}}, 0.061894273127753294`], 
        ArrowBox[{{0., 1.}, {-1., 0.}}, 0.061894273127753294`], 
        ArrowBox[{{-1., 4.}, {-1., 3.}}, 0.061894273127753294`], 
        ArrowBox[{{-1., 3.}, {-1., 2.}}, 0.061894273127753294`], 
        ArrowBox[{{0., 6.}, {0., 5.}}, 0.061894273127753294`], 
        ArrowBox[{{0., 5.}, {0., 4.}}, 0.061894273127753294`], 
        ArrowBox[{{-1., 8.}, {-1., 7.}}, 0.061894273127753294`], 
        ArrowBox[{{-1., 7.}, {-1., 6.}}, 0.061894273127753294`], 
        ArrowBox[{{-1., 6.}, {-1., 5.}}, 0.061894273127753294`], 
        ArrowBox[{{-1., 5.}, {-1., 4.}}, 0.061894273127753294`], 
        ArrowBox[{{0., 4.}, {0., 3.}}, 0.061894273127753294`], 
        ArrowBox[{{0., 3.}, {0., 2.}}, 0.061894273127753294`], 
        ArrowBox[{{-1., 9.}, {0., 8.}}, 0.061894273127753294`], 
        ArrowBox[{{-1., 9.}, {-1., 8.}}, 0.061894273127753294`]}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[
        0.7]}], {DiskBox[{0., 8.}, 0.061894273127753294], 
         InsetBox["1", 
          Offset[{2, 2}, {0.061894273127753294, 8.061894273127754}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{0., 7.}, 0.061894273127753294], 
         InsetBox["9", 
          Offset[{2, 2}, {0.061894273127753294, 7.061894273127753}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{-1., 2.}, 0.061894273127753294], 
         InsetBox["2", 
          Offset[{2, 2}, {-0.9381057268722467, 2.0618942731277534}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{-1., 1.}, 0.061894273127753294], 
         InsetBox["10", 
          Offset[{2, 2}, {-0.9381057268722467, 1.0618942731277532}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{0., 2.}, 0.061894273127753294], 
         InsetBox["3", 
          Offset[{2, 2}, {0.061894273127753294, 2.0618942731277534}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{0., 1.}, 0.061894273127753294], 
         InsetBox["11", 
          Offset[{2, 2}, {0.061894273127753294, 1.0618942731277532}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{-1., 4.}, 0.061894273127753294], 
         InsetBox["4", 
          Offset[{2, 2}, {-0.9381057268722467, 4.061894273127753}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{-1., 3.}, 0.061894273127753294], 
         InsetBox["12", 
          Offset[{2, 2}, {-0.9381057268722467, 3.0618942731277534}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{0., 6.}, 0.061894273127753294], 
         InsetBox["5", 
          Offset[{2, 2}, {0.061894273127753294, 6.061894273127753}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{0., 5.}, 0.061894273127753294], 
         InsetBox["13", 
          Offset[{2, 2}, {0.061894273127753294, 5.061894273127753}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{-1., 8.}, 0.061894273127753294], 
         InsetBox["6", 
          Offset[{2, 2}, {-0.9381057268722467, 8.061894273127754}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{-1., 7.}, 0.061894273127753294], 
         InsetBox["14", 
          Offset[{2, 2}, {-0.9381057268722467, 7.061894273127753}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{-1., 6.}, 0.061894273127753294], 
         InsetBox["7", 
          Offset[{2, 2}, {-0.9381057268722467, 6.061894273127753}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{-1., 5.}, 0.061894273127753294], 
         InsetBox["15", 
          Offset[{2, 2}, {-0.9381057268722467, 5.061894273127753}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{0., 4.}, 0.061894273127753294], 
         InsetBox["8", 
          Offset[{2, 2}, {0.061894273127753294, 4.061894273127753}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{0., 3.}, 0.061894273127753294], 
         InsetBox["16", 
          Offset[{2, 2}, {0.061894273127753294, 3.0618942731277534}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{-1., 9.}, 0.061894273127753294], 
         InsetBox["0", 
          Offset[{2, 2}, {-0.9381057268722467, 9.061894273127754}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}, {DiskBox[{-1., 0.}, 0.061894273127753294], 
         InsetBox["17", 
          Offset[{2, 2}, {-0.9381057268722467, 0.061894273127753294}], 
          ImageScaled[{0, 0}],
          BaseStyle->"Graphics"]}}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None]], "Output",
 CellChangeTimes->{3.844980598517556*^9, 3.84498104043569*^9, 
  3.845004804954055*^9, 3.8450077023520565`*^9, 3.8450088430528393`*^9, 
  3.845010477512618*^9},
 CellLabel->"Out[74]=",ExpressionUUID->"6893611c-d343-42cb-9f30-94731f578804"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["GurobiOptimization", "Subsection",
 CellChangeTimes->{{3.845007713443348*^9, 
  3.845007734950158*^9}},ExpressionUUID->"a4b0243e-6007-4807-8dd0-\
51ae2cb4d98b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Get", "[", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], ",", 
     "\"\<\\\\Gurobi-main\\\\GurobiOptimization.wl\>\""}], "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "directory", " ", "=", " ", "\"\<C:\\\\gurobi912\\\\win64\\\\bin\\\\\>\""}],
   ";"}]}], "Input",
 CellChangeTimes->{{3.843066786119773*^9, 3.843066786401025*^9}, 
   3.8430668368531923`*^9, {3.8431246255017385`*^9, 3.8431246441425695`*^9}, {
   3.8431246742982855`*^9, 3.843124682703143*^9}, {3.8431286023488355`*^9, 
   3.8431286275544186`*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"d5901f76-b9cd-44f9-b035-e1809f210e86"],

Cell[BoxData[
 RowBox[{
  RowBox[{"solGurobi", "=", 
   RowBox[{"GurobiOptimization", "[", 
    RowBox[{
     RowBox[{"Normal", "@", "c"}], ",", 
     RowBox[{"Normal", "@", "matr"}], ",", "bb", ",", "lu", ",", "domain", 
     ",", "directory"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.843067917496272*^9, 3.843125602277075*^9, {3.8450047021883373`*^9, 
   3.8450047338878126`*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"64e3397a-fc5b-44b5-bf95-e9c97b6a8c98"],

Cell[CellGroupData[{

Cell[BoxData["solGurobi"], "Input",
 CellChangeTimes->{{3.845004727129811*^9, 3.8450047303116207`*^9}, 
   3.845004811602287*^9},
 CellLabel->"In[78]:=",ExpressionUUID->"13bcb927-9750-432b-a1fe-7f92bb9c4cf4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
   "1", ",", "1", ",", "1", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "11.144999999999484`", ",", "11.549999999999628`", ",", 
   "7.177999999999486`", ",", "2.9999999999996447`", ",", "0", ",", 
   "4.832999999999473`", ",", "7.167999999999637`", ",", 
   "0.9299999999999926`", ",", "12.617999999999483`", ",", 
   "13.559999999999619`", ",", "9.718999999999482`", ",", 
   "5.343999999999639`", ",", "3.3739999999994694`", ",", 
   "7.120999999999469`", ",", "11.419999999999632`", ",", "0", ",", "0", ",", 
   "13.559999999999619`", ",", "12.617999999999483`", ",", "1", ",", "1", ",",
    "13.559999999999619`"}], "}"}]], "Output",
 CellChangeTimes->{3.845004812860826*^9, 3.8450077033794003`*^9, 
  3.8450088466490774`*^9, 3.8450104794632816`*^9},
 CellLabel->"Out[78]=",ExpressionUUID->"13ce6379-3b49-46fd-a309-ad1db165128a"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{949, 467},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
TaggingRules->Association["TryRealOnly" -> False],
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"91eec3e0-0313-44fa-ab02-9331fa6848c6"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 157, 3, 67, "Section",ExpressionUUID->"adedea70-c332-4e36-a7ef-9aeb958a147d"],
Cell[CellGroupData[{
Cell[762, 29, 208, 4, 54, "Subsection",ExpressionUUID->"7c147572-7bd2-4554-bc4f-1e0bce9e3d38"],
Cell[973, 35, 434, 12, 44, "Input",ExpressionUUID->"898d947d-9e30-466e-92ba-087fda760225",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1444, 52, 168, 3, 38, "Subsection",ExpressionUUID->"c9c1cbf4-7af8-49d8-b2dd-0bd09456f321"],
Cell[1615, 57, 2638, 45, 86, "Input",ExpressionUUID->"54f28b64-1408-46e0-b210-f3fcc250739b"],
Cell[4256, 104, 468, 8, 48, "Input",ExpressionUUID->"6c0fb735-492d-4934-9148-7b54c14a582a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[4773, 118, 193, 3, 67, "Section",ExpressionUUID->"8a679f96-9565-4f54-b540-80b6fd95e0d8"],
Cell[4969, 123, 957, 21, 67, "Input",ExpressionUUID->"c37b5b94-a28c-48bb-b561-528e84873399"],
Cell[5929, 146, 2179, 48, 86, "Input",ExpressionUUID->"659aed43-2131-4ae0-bae0-706556ac51fb"],
Cell[8111, 196, 466, 10, 28, "Input",ExpressionUUID->"b798c6ee-a541-444e-a42e-f00ce1d0e13c"],
Cell[8580, 208, 2861, 76, 143, "Input",ExpressionUUID->"90d267af-5a85-46e8-8a13-e692930ecd1a"],
Cell[11444, 286, 868, 19, 48, "Input",ExpressionUUID->"c71596d3-cdf6-4b94-9141-528583815d96"],
Cell[12315, 307, 1224, 30, 67, "Input",ExpressionUUID->"f802a249-8cd3-4265-aa58-b0f83100189f"],
Cell[13542, 339, 554, 14, 28, "Input",ExpressionUUID->"d8b7e5c6-6f1c-47de-80e4-2a93035f73a0"],
Cell[CellGroupData[{
Cell[14121, 357, 215, 4, 45, "Subsubsection",ExpressionUUID->"38d65518-c522-40ca-915c-10bc0d72f0e0"],
Cell[14339, 363, 1886, 47, 67, "Input",ExpressionUUID->"9cb68c5e-7de9-46f7-bb92-d6b5bb183cd4"],
Cell[16228, 412, 1639, 45, 86, "Input",ExpressionUUID->"59484561-1f09-4d19-9255-21143ae8ffdc"],
Cell[17870, 459, 788, 24, 48, "Input",ExpressionUUID->"6cedea7f-f6ca-429f-8e28-e6af610074d7"],
Cell[18661, 485, 532, 10, 28, "Input",ExpressionUUID->"e28cf248-a74e-455d-a8bd-9586f77ff54a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19230, 500, 278, 4, 45, "Subsubsection",ExpressionUUID->"d4667e9c-4565-4a50-bdf7-ba67f1722201"],
Cell[19511, 506, 808, 17, 48, "Input",ExpressionUUID->"e8001e8b-6675-4406-a861-cea9dcef20b3"],
Cell[20322, 525, 678, 19, 67, "Input",ExpressionUUID->"b48e5d6e-1e13-49b0-9096-f07b61ab8ec2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21037, 549, 246, 4, 45, "Subsubsection",ExpressionUUID->"c867dbfb-476a-4ebd-8dc2-14368aab28cf"],
Cell[21286, 555, 839, 23, 48, "Input",ExpressionUUID->"5c05e95f-2130-4ff7-94e6-ce25aefe566b"],
Cell[22128, 580, 903, 24, 48, "Input",ExpressionUUID->"13da95bb-e0de-423a-9c35-008e465c8601"],
Cell[23034, 606, 1049, 29, 48, "Input",ExpressionUUID->"a703b6a9-0c02-446d-b3bd-dca150945ed3"],
Cell[24086, 637, 1187, 32, 48, "Input",ExpressionUUID->"a5fdcd41-45cc-4d7b-bd36-366589a358e9"],
Cell[25276, 671, 1180, 32, 67, "Input",ExpressionUUID->"091f3405-7217-40fe-9119-3b847a95d97e"],
Cell[26459, 705, 699, 16, 48, "Input",ExpressionUUID->"50fecb20-e9fa-4d94-ba3f-c5ee0bd7fd45"],
Cell[27161, 723, 1156, 32, 48, "Input",ExpressionUUID->"ea3bf0c8-cf19-4885-a495-08ffb525de79"],
Cell[28320, 757, 1336, 38, 67, "Input",ExpressionUUID->"d35bf43c-acb1-465f-89a6-151ae695d77e"],
Cell[29659, 797, 1479, 40, 67, "Input",ExpressionUUID->"d1d2a6b9-6662-4f45-bb8e-19a6d018407f"],
Cell[31141, 839, 1471, 39, 48, "Input",ExpressionUUID->"e4aa3fed-1d95-4433-9d01-9b2106388122"],
Cell[32615, 880, 1428, 40, 67, "Input",ExpressionUUID->"21427704-b724-456d-9637-dda35c2ea5a0"],
Cell[34046, 922, 1419, 38, 48, "Input",ExpressionUUID->"66968f44-f7ea-40c1-baa5-57f669d0f78e"],
Cell[35468, 962, 2640, 73, 105, "Input",ExpressionUUID->"97a3775b-4779-40b0-a65f-4548ac551bdd"],
Cell[38111, 1037, 1695, 47, 124, "Input",ExpressionUUID->"7d974ad0-ef4e-4242-9397-c76cee2d47e2"],
Cell[39809, 1086, 1572, 42, 86, "Input",ExpressionUUID->"2dd3c1f8-84b6-4717-a27e-a28249571f94"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41418, 1133, 169, 3, 54, "Subsection",ExpressionUUID->"126d93b4-eb08-41d2-9526-b7415aed06db"],
Cell[41590, 1138, 2481, 67, 162, "Input",ExpressionUUID->"818f1568-b6fb-4dff-a288-af81dca4db11"],
Cell[CellGroupData[{
Cell[44096, 1209, 333, 7, 28, "Input",ExpressionUUID->"7463d2b7-7815-4e4f-95b6-a361c99a1a76"],
Cell[44432, 1218, 2533, 36, 90, "Output",ExpressionUUID->"70b4636a-f896-4230-aa58-0a2b9ae1f374"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47002, 1259, 608, 14, 28, "Input",ExpressionUUID->"76f80471-16c2-4f58-bbbe-00a91fd494ee"],
Cell[47613, 1275, 1329, 35, 52, "Output",ExpressionUUID->"c01ed00c-6943-4130-a39f-24cc50782ba7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48979, 1315, 832, 20, 48, "Input",ExpressionUUID->"86363692-6775-4c88-a82d-17f56378ad7b"],
Cell[49814, 1337, 700, 19, 32, "Output",ExpressionUUID->"22ac4c3e-409e-4aa4-8906-75b7552a6fcf"]
}, Open  ]],
Cell[50529, 1359, 780, 24, 28, "Input",ExpressionUUID->"d2dc429f-a649-4945-acc3-a8e223187db1"],
Cell[CellGroupData[{
Cell[51334, 1387, 420, 11, 28, "Input",ExpressionUUID->"13d50de8-3f53-4487-99c8-d99a9f617c60"],
Cell[51757, 1400, 5918, 111, 449, "Output",ExpressionUUID->"6893611c-d343-42cb-9f30-94731f578804"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[57724, 1517, 166, 3, 54, "Subsection",ExpressionUUID->"a4b0243e-6007-4807-8dd0-51ae2cb4d98b"],
Cell[57893, 1522, 700, 16, 48, "Input",ExpressionUUID->"d5901f76-b9cd-44f9-b035-e1809f210e86"],
Cell[58596, 1540, 472, 11, 28, "Input",ExpressionUUID->"64e3397a-fc5b-44b5-bf95-e9c97b6a8c98"],
Cell[CellGroupData[{
Cell[59093, 1555, 208, 3, 28, "Input",ExpressionUUID->"13bcb927-9750-432b-a1fe-7f92bb9c4cf4"],
Cell[59304, 1560, 1826, 27, 90, "Output",ExpressionUUID->"13ce6379-3b49-46fd-a309-ad1db165128a"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

